\documentclass[10pt,a4paper]{article}
\input{./preamble.tex}

\title{Local Fields}
\begin{document}
\maketitle
\tableofcontents\newpage
\section{Basic Theory}
Suppose we have a diophantine polynomial $f(x_1, \ldots, x_r) \in \Z[x_1, \ldots, x_r]$. Then we might want to find integer solutions to the equation $f(x_1, \ldots, x_r) = 0$. However, it turns out this can be very difficult to do, for instance showing $x^n + y^n - z^n = 0$ has no solutions for $x,y,z \in \Z$ took hundreds of years and a lot of advanced mathematics.

Instead, we study congruences of the form $f(x_1, \ldots, x_r) \equiv 0 \mod p^n$, for prime $p$ and integer $n$. This then becomes a finite computation, and hence a much easier problem. Local fields will give us a way to package all this information together.

\subsection{Absolute Values}
\begin{definition}
Let $K$ be a field. An \emph{absolute value} on $K$ is a function $\abs{\cdot}:K \to \R_{\geq 0}$ such that:
\begin{enumerate}
  \item $\abs{x} = 0 \iff x = 0$
  \item $\abs{xy} = \abs{x}\abs{y}\forall x, y \in K$
  \item $\abs{x+y} \leq \abs{x}+\abs{y}\forall x, y \in K$
\end{enumerate}
We say that $(K, \abs{\cdot})$ is a valued field.
\end{definition}
\underline{Examples: }
\begin{enumerate}
  \item $K = \R$ or $\C$ with $\abs{\cdot}$ the usual absolute value. We write $\abs{\cdot}_\infty$ for this absolute value.
  \item $K$ is any field. The \emph{trivial absolute value} on $K$ is defined by:
  \begin{align}
    \abs{x} = \begin{cases} 0 & x = 0 \\ 1 & x \neq 0 \end{cases}
  \end{align}
  We will ignore this absolute value in this course.
  \item $K = \Q$, $p$ a prime. For $0 \neq x \in \Q$, we can write $x = p^n \frac{a}{b}$, where $a, b \in \Z, (a, p) = 1$, and $(b, p) = 1$. The \emph{p-adic absolute value} is defined to be:
  \begin{align*}
    \abs{x}_p = \begin{cases} 0 & x = 0 \\ p^{-n} & x = p^n\frac{a}{b} \end{cases}
  \end{align*}
  We check the axioms.
  \begin{enumerate}[label=\textit{\arabic*.}]
    \item Clear from the definition.
    \item $\abs{xy}_p = \abs{p^{m+n}\frac{ac}{bd}}_p = p^{-m-n} = \abs{x}_p\abs{y}_p$
    \item \textsc{Wlog}, $m\geq n$. $\abs{x+y}_p = \left|p^n\left(\frac{ad+p^{m-n}bc}{bd}\right)\right|_p \leq p^{-n} = \max(\abs{x}_p, \abs{y}_p)$
  \end{enumerate}
\end{enumerate}
An absolute value on $K$ induces a metric $d(x,y) = \abs{x-y}$ on $K$, and hence induces a topology on $K$. As an exercise, check that $+, \cdot$ are continuous.

\begin{definition}
  Let $\abs{\cdot}, \abs{\cdot}'$ be absolute values on a field $K$. We say that $\abs{\cdot}, \abs{\cdot}'$ are \emph{equivalent} if they induce the same topology on $K$. An equivalence class of absolute values is called a \emph{place}.
\end{definition}

\begin{proposition}
  Let $\abs{\cdot}, \abs{\cdot}'$ be non-trivial absolute values on $K$. The following are equivalent:
  \begin{enumerate}
    \item $\abs{\cdot}, \abs{\cdot}'$ are equivalent.
    \item $\abs{x} < 1 \iff \abs{x}' < 1 \forall x\in K$.
    \item $\exists c \in \R_{>0} \st \abs{x}^c = \abs{x}' \forall x \in K$
  \end{enumerate}
\end{proposition}
\begin{proof}\hspace*{0cm}\\
  \imp{1}{2}
  \begin{align}
    \abs{x}<1 &\iff x^n \to 0 \wrt \abs{\cdot}\\
    &\iff x^n \to 0 \wrt \abs{\cdot}'\\
    &\iff \abs{x}' < 1
  \end{align}

  \imp{2}{3} Let $a \in K^{\times} \st \abs{a} < 1$, which exists since $\abs{\cdot}$ is non-trivial. We need to show that, for all $x \in K^\times$, we have:
  \begin{align*}
    \frac{\log\abs{x}}{\log\abs{a}} = \frac{\log\abs{x}'}{\log\abs{a}'}
  \end{align*}
  Assume $\frac{\log\abs{x}}{\log\abs{a}} < \frac{\log\abs{x}'}{\log\abs{a}'}$. Then choose $m,n \in \Z$ so that $\frac{\log\abs{x}}{\log\abs{a}} < \frac{m}{n} < \frac{\log\abs{x}'}{\log\abs{a}'}$. Then we have:
  \begin{align*}
    n \log \abs{x} &< m \log \abs{a}\\
    n \log \abs{x}' &> m \log \abs{a}'
  \end{align*}
  and hence $\abs{\frac{x^n}{a^m}} < 1, \abs{\frac{x^n}{a^m}}' > 1, \contr.$

  \imp{3}{1} This is clear, as open balls in one topology will also be open balls in the other, hence the topologies will be the same.
\end{proof}

In this course, we will be mainly interested in the following types of absolute values:
\begin{definition}
  An absolute value $\abs{\cdot}$ on $K$ is said to be \emph{non-archimedean} if it satisfies the ultrametric inequality $\abs{x+y} \leq \max(\abs{x}, \abs{y})$
\end{definition}
If $\abs{\cdot}$ is not non-archimedean, then it is archimedean.\\
\underline{Examples: }
\begin{enumerate}
  \item $\abs{\cdot}_\infty$ on $\R$ is archimedean.
  \item $\abs{\cdot}_p$ is a non-archimedean absolute value on $\Q$.
\end{enumerate}
\begin{lemma}[All triangles are isosceles]
    Let $(K, \abs{\cdot})$ be a non-archimedean valued field, and $x, y \in K$. If $\abs{x}<\abs{y}$, then $\abs{x-y} = \abs{y}$.
\end{lemma}
\begin{proof}
  Observe that $\abs{1} = \abs{1\cdot 1} = \abs{1}\cdot \abs{1}$, and so $\abs{1} = 1$ or $0$. But $1 \neq 0$, so $\abs{1} = 1$. Similarly, $\abs{-1} = 1$, and so $\abs{-y} = \abs{y}$ for all $y \in K$.

  Then if $\abs{x} < \abs{y}$,  $\abs{x-y} \leq \max(\abs{x}, \abs{y}) = \abs{y}$.

  At the same time $\abs{y} \leq \max(\abs{x}, \abs{x-y}) \implies \abs{y} \leq \abs{x-y}$.

  Hence $\abs{y} = \abs{x-y}$.
\end{proof}

\begin{proposition}
  Let $(K, \abs{\cdot})$ be non-archimedean, and $(x_n)_{n=1}^\infty$ be a sequence in $K$.

  If $\abs{x_n-x_{n+1}} \to 0$, then $(x_n)_{n=1}^\infty$ is Cauchy.

  In particular, if $K$ is in addition complete, then $(x_n)_{n=1}^\infty$ converges.
\end{proposition}
\begin{proof}
  For $\epsilon > 0$, choose $N$ such that $\abs{x_n - x_{n+1}} < \epsilon\forall n>N$.

  Then for $N < n < m$, we have:
  \begin{align*}
    \abs{x_n-x_m} &= \abs{(x_n-x_{n+1}) + (x_{n+1}-x_{n+1}) +\ldots + (x_{m-1} - x_m)} < \epsilon
  \end{align*}
  And so the sequence is Cauchy.
\end{proof}

For example, if $p=5$, construct the sequence $(x_n)_{n=1}^\infty$ such that:
\begin{enumerate}
  \item $x_n^2+ 1\equiv 0 \mod 5^n$
  \item $x_n \equiv x_{n+1} \mod 5^n$
\end{enumerate}
as follows:

Take $x_1 = 2$. Suppose we have constructed $x_n$. Let $x_n^2 + 1 = a5^n$, and set $x_{n+1} = x_n + b5^n$. Then $x_{n+1}^2 + 1=  x_n^2 + 2b5^nx_n + b^2 5^{2n} + 1 = a5^n + 2b5^nx_n + b^2 5^{2n}$.

We choose $b$ such that $a+2bx_n \equiv 0 \mod 5$, i.e. $b \equiv -\frac{a}{2x_n} \mod 5$, and then we have $x_{n+1}^2 +1 \equiv 0 \mod 5^{n+1}$ as desired.

The second property implies that $\abs{x_{n+1} - x_n}_5 < 5^{-n} \to 0$, and so the sequence is Cauchy. Now suppose that $x_n \to L \in \Q$. Then $x_n^2 \to L^2$. But the first property then gives us that $x_n^2 \to -1 \implies L^2 = -1 \contr.$ So $(\Q, \abs{\cdot}_5)$ is not complete.

\begin{definition}
  The $p$-adic numbers $\Q_p$ is the completion of $\Q$ with respect to $\abs{\cdot}_p$.
\end{definition}
We have an analogy with $\R$, in that $\R$ is the completion of $\Q$ with respect to $\abs{\cdot}_\infty$.

If $(K, \abs{\cdot})$ is a valued field, for $x \in K, r \in \R_{>0}$, we define:
\begin{align*}
  B(x, r) &= \{y \in K : \abs{x-y} < r \}\\
  \overline{B}(x, r) &= \{y \in K : \abs{x-y} \leq r\}
\end{align*}
and call these the \emph{open} and \emph{closed balls} of radius $r$ centred at $x$, respectively.

\begin{lemma}
  Let $(K, \abs{\cdot})$ be non-archimedean. Then:
  \begin{enumerate}
    \item If $z \in B(x, r)$, then $B(z, r) = B(x, r)$.
    \item If $z \in \overline{B}(x, r)$, then $\overline{B}(z, r) = \overline{B}(x, r)$.
    \item $B(x, r)$ is closed.
    \item $\overline{B}(x, r)$ is open.
  \end{enumerate}
\end{lemma}
\begin{proof}\hspace*{0cm}
  \begin{enumerate}[label=\textit{\arabic*.}]
    \item Let $y \in B(x, r)$. Then $\abs{x-y} < r \implies \abs{z-y} = \abs{(z-x) + (x-y)} \leq \max(\abs{z-x}, \abs{x-y}) < r$.
    \item Same as in \textit{1.}, but with $\leq$ instead of $<$.
    \item Let $y \notin B(x, r)$. We need to show there is an open neighbourhood of $y$ not intersecting $B(x, r)$. If $z \in B(x, r) \cap B(y, r)$, then $B(x, r) = B(z, r) = B(y, r)$. But then $y \in B(x, r) \contr.$ So $B(x, r)$ and $B(y, r)$ are disjoint, and so $B(x, r)$ is closed.
    \item If $z \in \overline{B}(x, r)$, then we need to show there is an open neighbourhood of $z$ contained in $\overline{B}(x, r)$. But $B(z, r) \subseteq \overline{B}(z, r) = \overline{B}(x, r)$, and so $\overline{B}(x, r)$ is open.
  \end{enumerate}
\end{proof}

\section{Valuation Rings}
\begin{definition}
  Let $K$ be a field. A \emph{valuation} on $K$ is a function $v: K^\times \to \R$ such that:
  \begin{enumerate}
    \item $v(xy) = v(x) + v(y)$
    \item $v(x+y) \geq \min\{v(x), v(y)\}$
  \end{enumerate}
\end{definition}
Fix $0 <\alpha<1$. If $v$ is a valuation on $K$, then $\abs{x} = \begin{cases} \alpha^{v(x)} & x \neq 0 \\ 0 & x = 0\end{cases}\;$ determines a non-archimedean absolute value. Conversely, a non-archimedean absolute value determines a valuation $v(x) = \log_\alpha \abs{x}$.

We will ignore the trivial valuation $v(x) \equiv 0$, which corresponds to the trivial absolute value.

We say $v_1, v_2$ are \emph{equivalent} if $\exists c \in \R_{>0}$ such that $v_1(x) = cv_2(x) \forall x \in K^\times$.

\underline{Examples:}
\begin{itemize}
  \item $K = \Q, v_p(x) = -\log_p \abs{x}_p$ is the $p$-adic valuation.
  \item $k$ any field, $K = k(t) = \Frac(k[t])$, the rational function field. $v\left(t^n \frac{f(t)}{g(t)}\right) =n$ where $f, g \in k[t], f(0), g(0) \neq 0$. This is the $t$-adic valuation.
  \item $K = k((t)) = \Frac(k[[t]])$, the field of \emph{formal Laurent series over k}. Then we have $v\left(\sum_i a_i t^i\right) = \min \{i : a_i \neq 0\}$ is the $t$-adic valuation on $K$.
\end{itemize}

\begin{definition}
  Let $(K, \abs{\cdot})$ be a non-archimedean valued field. The \emph{valuation ring} of $K$ is defined to be:
  \begin{align*}
    \O_K &= \{ x \in K : \abs{x} \leq 1\}\;\;\; (= \bar{B}(0, 1))\\
    &= \{x \in K^\times : v(x) \geq 0\}\cup\{0\}
  \end{align*}
\end{definition}
\begin{proposition}\hspace*{0cm}
  \begin{enumerate}
    \item $\O_K$ is an open subring of $K$.
    \item The subsets $\{x \in K : \abs{x} \leq r\}$ and $\{x \in K : \abs{x} < r\}$ for $r \leq 1$ are open ideals in $\O_K$.
    \item $\O_K^\times = \{x\in K : \abs{x} = 1\}$.
  \end{enumerate}
\end{proposition}
\begin{proof}\hspace*{0cm}
  \begin{enumerate}[label = \textit{\arabic*}.]
    \item $\abs{1} = 1, \abs{0} = 0$, so $1, 0 \in \O_K$. $\abs{-x} = \abs{x}$, so $x \in \O_K \implies -x \in \O_K$. If $x, y \in \O_K$, then $\abs{x+y} \leq \max(\abs{x}, \abs{y}) \leq 1$, and so $x+y \in \O_K$, and $\abs{xy} = \abs{x}\abs{y} \leq 1$, so $xy \in \O_K$. Since $\O_K = \bar{B}(0, 1)$, it is open.
    \item The proof of this is the same as \textit{1.}
    \item Note that $\abs{x}\abs{x^{-1}} = \abs{xx^{-1}} = 1$. So $\abs{x} = 1 \iff \abs{x^{-1}} = 1$. This can happen if and only if $x, x^{-1} \in \O_K$, i.e. $x \in \O_K^\times$.
  \end{enumerate}
\end{proof}
As a point of notation, we will define $m \coloneqq \{x \in \O_K : \abs{x}<1\}$, a maximal ideal of $\O_K$, and $k \coloneqq \O_K/m$ to be the \emph{residue field}.

We say a ring $R$ is \emph{local} if it has a unique maximal ideal. As an exercise, prove that $R$ is local if and only if $R\setminus R^\times$ is an ideal of $R$. We can use this to prove the following:

\begin{corollary}
  $\O_K$ is a local ring with a unique maximal ideal $m$.
\end{corollary}
\begin{proof}
  Suppose $x \in \O_K \setminus m$. Then $\abs{x} = 1$, so $x^{-1} \in \O_K$, and so any ideal containing $x$ contains $x^{-1}x = 1$, i.e. is all of $\O_K$, and hence $m$ is the unique maximal ideal in $\O_K$.
\end{proof}

\underline{Examples:}
\begin{itemize}
  \item $K = k((t)), \O_K = k[[t]], m = (t)$, and the residue field is $k$.
  \item $K = \Q$ with $\abs{\cdot}_p$. $\O_K = \Z_{(p)}, m = p\Z_{(p)}, k = \F_p$.
\end{itemize}

\begin{definition}
  Let $v : K^\times \to \R$ be a valuation. If $v(K^\times) \cong \Z$, we say $v$ is a \emph{discrete valuation}, and $K$ is said to be a \emph{discretely valued field}. An element $\pi \in \O_K$ is a \emph{uniformizer} if $v(\pi) = 0$ and $v(\pi)$ generates $v(K^\times)$.
\end{definition}
\underline{Remark:} If $v$ is a discrete valuation, we can replace it with an equivalent one such that $v(K^\times) = \Z \subseteq \R$. Such $v$ are called \emph{normalized valuations}, and have $v(\pi) = 1$ for $\pi$ a uniformizer.

\begin{lemma}
  Let $v$ be a valuation on $K$. Then the following are all equivalent:
  \begin{enumerate}
    \item $v$ is discrete.
    \item $\O_K$ is a PID.
    \item $\O_K$ is noetherian.
    \item $m$ is principal.
  \end{enumerate}
\end{lemma}
\begin{proof}\hspace*{0cm}\\
    \imp{1}{2} Let $I\subseteq \O_K$ be a non-zero ideal. Let $x \in I$ such that $v(x) = \min\{v(a) : a \in I\}$, which exists since $v$ is discrete. Then $x \O_K = \{a \in O_K : v(a) \geq v(x) \} \subseteq I$, and hence $x\O_K = I$ by definition of $x$ - if $y \in I\setminus (x)$, then $v(y) < v(x) \contr.$

    \imp{2}{3} Every PID is noetherian, as all ideals are finitely generated (by a single element).

    \imp{3}{4} Write $m = x_1\O_K + \ldots + x_n\O_K$. \textsc{Wlog}, $v(x_1) \leq v(x_2) \leq\ldots\leq v(x_n)$. Then $m = x_1\O_K$.

    \imp{4}{1} Let $m=\pi\O_K$ for some $\pi\in\O_K$, and let $c = v(\pi)$. Then if $v(x) > 0$, $x \in m$ and hence $v(x) \geq c$. Thus $v(K^\times)\cap(0, c) = \emptyset$. Since $v(K^\times)$ is a subgroup of $(\R, +)$, we have $v(K^\times) = c\Z$.
\end{proof}
\begin{lemma}
  Let $v$ be a discrete valuation on $K$, and $\pi \in \O_K$ a uniformizer. Then for any $x \in K^\times$ there exists $n \in \Z$ and $u \in \O_K^\times$ such that $x = \pi^n u$. In particular, $K = \O_K\left[\frac{1}{x}\right]$ for any $x \in m$ and hence $K = \Frac \O_K$.
\end{lemma}
\begin{proof}
  For any $x \in K^\times$, let $n$ be such that $v(x) = v(\pi^n) = nv(\pi)$, then $v(x\pi^{-n}) = 0 \implies u = x\pi^{-n}\in \O_K^\times$.
\end{proof}

\begin{definition}
  A ring $R$ is called a \emph{discrete valuation ring (DVR)} if it is a PID with exactly one non-zero prime ideal.
\end{definition}
\begin{lemma}\hspace*{0cm}
  \begin{enumerate}
    \item Let $v$ be a discrete valuation on $K$. Then $\O_K$ is a DVR.
    \item Let $R$ be a DVR. Then there is a valuation $v$ on $K \coloneqq \Frac(R)$ such that $R = \O_K$.
  \end{enumerate}
\end{lemma}
\begin{proof}\hspace*{0cm}
  \begin{enumerate}
    \item $\O_K$ is a PID by \textbf{2.6}. Let $0 \neq I \subseteq \O_K$ be an ideal, then $I = (x)$ for some $x$. If $x = \pi^nu$ for $\pi$ a uniformizer, then $(x)$ is prime if and only if $n = 1$, and $I = (\pi) = m$.

    \item Let $R$ be a DVR with maximal ideal $m$. Then $m = (\pi)$ for some $\pi \in R$. Since PIDs are UFDs, we may write $x \in R\setminus\{0\}$ uniquely as $\pi^n u, n\geq0, u \in R^\times$. Then any $y \in K\setminus\{0\}$ can be written uniquely as $\pi^m u, u \in R^\times, m \in \Z$. Then define $v(\pi^m u) = m$, and it is easy to check $v$ is a valuation and $\O_K = R$.
  \end{enumerate}
\end{proof}

\underline{Examples:}
\begin{itemize}
  \item $\Z_{(p)}$ is a DVR, the valuation ring of $\abs{\cdot}_p$ on $\Q$.
  \item $k[[t]]$ is a DVR, the valuation ring of the $t$-adic valuation on $k((t))$.
  \item $K = k(t), K' = K\left(t^{\frac12}, t^{\frac14}, t^{\frac18}, \ldots\right)$. The $t$-adic valuation extends to $K'$, but we must have $v(t^{\frac{1}{2^n}}) = \frac{1}{2^n}$, which is not discrete.
\end{itemize}

\section{The p-adic Numbers}
Recall that $\Q_p$ is defined to be the completion of $\Q$ with respect to the metric induced by $\abs{\cdot}_p$. On example sheet 1, we prove that $\Q_p$ is a field. $\abs{\cdot}_p$ extends from $\Q$ to $\Q_p$, and the associated valuation is discrete, so $\Q_p$ is a discretely valued field.

\begin{definition}
  The \emph{ring of p-adic integers}, $\Z_p$, is the valuation ring $\{x \in \Q_p : \abs{x}_p \leq 1\}$.
\end{definition}
$\Z_p$ is a discrete valuation ring with maximal ideal $p\Z_p$, and all non-zero ideals in $\Z_p$ are of the form $p^n \Z_p$ for $n \in \N$.

\begin{proposition}
  $\Z_p$ is the closure of $\Z$ inside $\Q_p$. In particular, $\Z_p$ is the completion of $\Z$ with respect to $\abs{\cdot}_p$.
\end{proposition}
\begin{proof}
  We need to show that $\Z$ is dense in $\Z_p$. We know that $\Q$ is dense in $\Q_p$. Since $\Z_p \subseteq \Q_p$ is a closed ball and hence open, $\Z_p \cap \Q$ is dense in $\Z_p$.
  \begin{align*}
    \Z_p \cap \Q &= \{x \in \Q : \abs{x}_p \leq 1\}\\
    &= \left\{\frac{a}{b} \in \Q : p \nmid b\right\}\\
    &= \Z_{(p)}
  \end{align*}
  Thus it suffices to show that $\Z$ is dense in $\Z_{(p)}$.

  Let $\frac{a}{b} \in \Z_{(p)}$, so that $a, b \in \Z, p\nmid b$. For $n \in \N$, choose $y_n\in\Z$ such that $by_n \equiv a \mod p^n$. Then $y_n \to \frac{a}{b}$ as $n \to \infty$.

  In particular, $\Z$ is dense in $\Z_p$ which is complete.
\end{proof}

\subsection{Brief Digression on Inverse Limits}
Let $(A_n)_{n=1}^\infty$ be a sequence of sets/groups/rings together with homomorphisms $\varphi_n : A_{n+1} \to A_n$, called transition maps. The \emph{inverse limit} of $(A_n)_{n=1}^\infty$ is the set of sequences of elements given by:
\begin{align*}
  \lim_{\xleftarrow[n]{}} A_n = \left\{(a_n)_{n=1}^\infty \in \prod_{n=1}^\infty A_n : \varphi_n(a_{n+1}) = a_n\right\}
\end{align*}
so that $a_{n+1} \xmapsto{\varphi_{n}} a_n \xmapsto{\varphi_{n-1}} a_{n-1}$. If the $A_n$ are groups/rings, then $\lim_{\xleftarrow[n]{}} A_n$ is a group/ring respectively.

Let $\theta_m : \lim_{\xrightarrow[n]{}}A_n \to A_m$ denote the natural projection map.

The inverse limit satisfies the following universal property:
\begin{proposition}
  Let $((A_n)_{n=1}^\infty, (\varphi_n)_{n=1}^\infty)$ as above. Then for any set/group/ring $B$ together with homomorphisms $\psi_n : B \to A_n$ such that the diagram
  \begin{tikzcd}
    B \arrow{r}{\psi_{n+1}} \arrow{dr}{\psi_n} & A_{n+1} \arrow{d}{\varphi_n} \\ & A_n
  \end{tikzcd} commutes for all $n$, there is a unique homomorphism $\psi: B \to \lim\limits_{\xleftarrow[n]{}} A_n$ such that $\theta_n \circ \psi = \psi_n$.
\end{proposition}

\begin{proof}
  Define $\psi: B \to \prod_{n=1}^\infty A_n$ by $b \mapsto \prod_{n=1}^\infty \{\psi_n(b)\}$.

  Then $\psi_n = \varphi_n \circ \psi_{n+1} \implies \psi(b) \in \lim\limits_{\xleftarrow[n]{}} A_n$.

  This map is clearly unique, as it is determined by $\psi_n = \varphi_n \circ \psi_{n+1}$, and is a homomorphism of rings.
\end{proof}

\begin{definition}
  Let $R$ be a ring and $I \subseteq R$ an ideal. The \emph{I-adic completion of R} is the ring $\hat{R} \coloneqq \lim\limits_{\xleftarrow[n]{}} R/I^n$, where $\varphi_n : R/I^{n+1} \to R/I^n$ is the natural projection.
\end{definition}

Note that there is a natural map $i:R \to \hat{R}$ by the universal property. We say that $R$ is $I$-adically complete if $i$ is an isomorphism.

As a fact, $\ker(i: R \to \hat{R}) = \bigcap_{n=1}^\infty I^n$.

Let $(K, \abs{\cdot})$ be a non-archimedean valued field, and $\pi \in \O_K$ such that $\abs{\pi} < 1$.
\begin{proposition}
  Assume that $K$ is complete. Then:
  \begin{enumerate}
    \item $\O_K \cong \lim\limits_{\xleftarrow[n]{}} \O_K/\pi^n\O_K$, i.e. $\O_K$ is $\pi$-adically complete.
    \item If in addition $K$ is discretely valued and $\pi$ is a uniformizer, then every element $x \in \O_K$ can be written uniquely as $x = \sum_{i=0}^\infty a_i \pi^i$ for $a_i \in A$ where $A$ is a set of coset representatives for $k\coloneqq \O_K/\pi\O_K$.

    Moreover, any series $\sum_{i=0}^\infty a_i \pi^i$ converges in $\O_K$.
  \end{enumerate}
\end{proposition}

\begin{proof}\hspace*{0cm}
  \begin{enumerate}[label=\textit{\arabic*.}]
    \item There is a natural map $i:\O_K \to \lim\limits_{\xleftarrow[n]{}} \O_K/\pi\O_K$. Since $\bigcap_{n=1}^\infty \pi^n \O_K = \{0\}$, $i$ is injective. Now let $(x_n)_{n=1}^\infty \in \lim\limits_{\xleftarrow[n]{}}\O_K/\pi^n\O_K$,
    and for each $n$ choose $y_n \in \O_K$ a lift of $x_n \in \O_K/\pi^n\O_K$.

    Let $v$ be the valuation on $K$ normalised such that $v(\pi) = 1$, then $v(y_n - y_{n+1}) \geq n$, as $y_n - y_{n+1} \in \pi^n \O_K$.

    So $(y_n)_{n=1}^\infty$ is a Cauchy sequence in $\O_K$, but $\O_K$ is complete as $\O_K \subseteq K$ is closed, and we assumed $K$ complete.

    So $y_n \to y$ and $i(y) = (x_n)_{n=1}^\infty$, so $i$ is surjective, and hence an isomorphism.

    \item Let $x \in \O_K$. Choose $a_i$ inductively as follows:

    Choose $a_0 \in A$ such that $a_0 \equiv x \mod \pi\O_K$. Suppose we have chosen $a_0, \ldots, a_k$ such that $\sum_{i=0}^k a_i \pi^i \equiv x \mod \pi^{k+1}$, Then $a_i \pi^i - x  = c\pi^{k+1}$ for some $c \in \O_K$. Then choose $a_{k+1} \equiv c \mod \pi\O_K$.

    Then $\sum_{i=0}^{k+1} a_i \equiv x \mod \pi^{k+2}\O_K$, and so $\sum_{i=0}^\infty a_i =x$.

    For uniqueness, assume that $\sum_{i=0}^\infty a_i \pi^i = \sum_{i=0}^\infty b_i \pi^i \in \O_K$. Let $n$ be minimal such that $a_n \neq b_n$. Then $\sum_{i=0}^\infty a_i \nequiv \sum_{i=0}^\infty b_i \pi^i \mod \pi^{n+1} \contr.$

    For the moreover part, any series of this form defines a Cauchy sequence, which as in \textit{1} converges in $\O_K$.
  \end{enumerate}
\end{proof}

Warning: if $(K, \abs{\cdot})$ is not discretely valued, then $\O_K$ is not necessarily $m$-adically complete.

\begin{corollary}
  If $K$ is as in \textit{2} of \textbf{3.5}, then every $x \in K$ can be written uniquely as a series of the form $\sum_{i=n}^\infty a_i \pi^i, a_i \in A$. Conversely, any such expression defines an element of $K$.
\end{corollary}

\begin{proof}
  Use the fact that $K = \O_K\left[\frac{1}{\pi}\right]$.
\end{proof}
\begin{corollary}\hspace*{0cm}
  \begin{enumerate}
    \item $\Z_p \cong \lim\limits_{\xleftarrow[n]{}} \Z/p^n\Z$.
    \item Every element of $\Q_p$ can be written uniquely as $\sum_{i=n}^\infty a_i p^i$ where $a_i \in \{0, 1, \ldots, p-1\}$.
  \end{enumerate}
\end{corollary}
\begin{proof}\hspace*{0cm}
  \begin{enumerate}[label=\textit{\arabic*.}]
    \item By \textbf{3.5} it is sufficient to show that $\Z_p/p^n\Z_p \cong \Z/p^n\Z$. Note that there is a natural map $f_n : \Z \to \Z_p/p^n\Z_p$, since $\Z \subseteq \Z_p$.

    We have that $\ker f_n = \{x \in \Z : \abs{x}_p \leq p^{-n}\} = p^n \Z$.

    Hence, $\Z/p^n\Z \to \Z_p/p^n\Z_p$ is injective.

    For surjectivity, let $\bar{c} \in \Z_p/p^n\Z_p$, and $c \in \Z_p$ a lift. Since $\Z$ is dense in $\Z_p$, we can choose $x \in \Z$ such that $x \in c + p^n\Z_p$. This is a closed ball and hence open, so $f_n(x) = \bar{c}$, and the map is surjective.

    \item Follows from \textbf{3.6}, noting that $\Z_p/p\Z_p \cong \Z/p\Z = \{0, 1, \ldots, p-1\}$ by \textit{1.}
  \end{enumerate}
\end{proof}

\underline{Examples:}
\begin{itemize}
  \item $\frac{1}{1-p} = 1 + p + p^2 + p^3 + \ldots \in \Q_p$.
  \item Let $K = k((t))$ with the $t$-adic valuation. Then $\O_K = k[[t]] = \lim\limits_{\xleftarrow[n]{}} k[[t]]/(t^n)$. Moreover, $\O_K$ is the $t$-adic completion of $k[t]$.
\end{itemize}
\section{Complete Valued Fields}
\subsection{Hensel's Lemma}
For complete valued fields, there is a nice way to produce solutions in $\O_K$ to certain equations from the solutions mod $m$.

Given $f \in R[x]$ for some ring $R$, we will denote by $f'$ the \emph{formal derivative} of $f$, which is the image of $f$ under the linear map taking $x^n \mapsto nx^{n-1}$.

\begin{theorem}[Hensel's Lemma, version 1]
  Let $(K, \abs{\cdot})$ be a complete discretely valued field. Let $f(x) \in \O_K[x]$, and assume there exists $a \in \O_K$ such that $\abs{f(a)} < \abs{f'(a)}^2$.

  Then there exists a unique $x \in \mathcal{O}_K$ such that $f(x) = 0$ and $\abs{x-a} < \abs{f'(a)}$.
\end{theorem}

\begin{proof}
  Let $\pi \in \O_K$ be a uniformizer, and let $r = v(f'(a))$. We construct a sequence $(x_n)_{n=1}^\infty$ in $\O_K$ such that:
  \begin{enumerate}[label=(\roman*)]
    \item $f(x_n) \equiv 0 \mod \pi^{n+2r}$
    \item $x_{n+1} \equiv x_n \mod \pi^{n+r}$
  \end{enumerate}
  Take $x_1 = a$; then $f(x_1) \equiv 0 \mod \pi^{1+2r}$.

  Suppose we've constructed $x_1, \ldots, x_n$ satisfying (i) and (ii). Define $x_{n+1}\coloneqq x_n - \frac{f(x_n)}{f'(x_n)}$. Since $x_n \equiv x_1 \mod \pi^{r+1}, v(f'(x_n)) = r$, and hence $\frac{f(x_n)}{f'(x_n)}\equiv 0 \mod \pi^{n+r}$ by (i).

  It follows that $x_{n+1} \equiv x_n \mod \pi^{n+r}$, so (ii) holds.

  Note that for $x, y$ indeterminates, $f(x+y) = f_0(x)+f_1(x)y + f_2(x)y^2 + \ldots$, where $f_i(x) \in \O_K[x]$, and $f_0(x) = f(x), f_1(x) = f'(x)$.

  Thus $f(x_{n+1}) = f(x_n) + f'(x_n)c+f_2(x_n)c^2 + \ldots$, where $c = -\frac{f(x_n)}{f'(x_n)} \equiv 0 \mod \pi^{n+r}$. Then since $v(f_i(x_n)) \geq 0$, we have $f(x_{n+1}) \equiv f(x_n) + f'(x_n)c \equiv 0 \mod \pi^{n+2r+1}$, and so (i) holds.

  This gives a construction of $(x_n)_{n=1}^\infty$. Property (ii) implies our sequence is Cauchy, so by completeness it converges to $x \in \O_K$. Then $f(x) = \lim_{n\to\infty} f(x_n) = 0$, which is zero by $(i)$.

  Moreover, (ii) implies:
  \begin{align*}
    a &= x_1 \equiv x_n \mod \pi^{r+1} \forall n\\
    \implies a &\equiv x \mod \pi^{r+1}\\
    \implies \abs{x-a} &< \abs{f'(a)}
  \end{align*}
  This proves existence.

  For uniqueness, suppose $x'$ also satisfies $f(x') = 0, \abs{x'-a} < \abs{f'(a)}$. Let $\delta = \abs{x'-x} \gneq 0$.

  Then $\abs{x'-a} < \abs{f'(a)}, \abs{x-a} < \abs{f'(a)}$, and the ultrametric inequality implies:
  \[\abs{\delta} = \abs{x-x'} < \abs{f'(a)} = \abs{f'(x)}\]
  But $0 = f(x') = f(x+\delta) = f(x) + f'(x)+\delta + \ldots$, where absolute value of the higher order terms is $\leq \abs{\delta}^2$.

  Hence $\abs{f'(x)\delta} \leq \abs{\delta}^2 \implies \abs{f'(x)} \leq \abs{\delta} \contr$.
\end{proof}

The following corollary is a slightly weaker result, but will often turn out to be more useful for what we want to do.

\begin{corollary}
  Let $(K, \abs{\cdot})$ be a complete discretely valued field. Let $f(x)\in \O_K[x]$, and $\bar{c}\in k\coloneqq \O_K/m$ a simple root of $\bar{f}(x) \coloneqq f(x) \mod m \in k[x]$ (i.e. not a root of $\bar{f}'(x)$).

  Then there is a unique $x \in \O_K$ such that $f(x) = 0$ and $x \equiv \bar{c} \mod m$.
\end{corollary}
\begin{proof}
  Apply \textbf{4.1} to a lift $c \in \O_K$ of $\bar{c}$. Then $\abs{f(c)} < \abs{f'(c)}^2 = 1$, since $\bar{c}$ is a simple root.
\end{proof}

\underline{Example:} $f(x) = x^2-2$ has a simple root mod 7. Thus $\sqrt{2} \in \Z_7 \subseteq \Q_7$.

\begin{corollary}
  \[\Q_p^\times/(\Q_p^\times)^2 \cong \begin{cases} (\Z/2\Z)^2 & p > 2 \\ (\Z/2\Z)^3 & p=2 \end{cases}\]
\end{corollary}
\begin{proof}\hspace*{0cm}
  \begin{itemize}
    \item[\underline{$p>2$:}] Let $b \in \Z_p^\times$. By \textbf{4.2} applied to $f(x) = x^2-b$, we have $b \in (\Z_p^\times)^2$ if and only if $b \in (\F_p^\times)^2$.

    Thus $\Z_p^\times/(\Z_p^\times)^2 \cong \F_p^\times/(\F_p^\times)^2 \cong \Z/2\Z$, since $\F_p^\times \cong \Z/(p-1)\Z$.

    We have an isomorphism $ \Z_p^\times \times \Z \cong\Q_p^\times$, given by $(u, n) \mapsto u\pi^n$.

    Thus $\Q_p^\times/(\Q_p^\times)^2 \cong (\Z/2\Z)^2$.

    \item[\underline{$p=2$:}] Let $b \in \Z_2^\times$. Consider $f(x) = x^2-b$. Then $f'(x) = 2x \equiv 0 \mod 2$, so we can't use \textbf{4.1}.

    Let $b \equiv 1 \mod 8$. Then $\abs{f(1)}_2 \leq 2^{-3} < \abs{f'(1)}_2^2 = 2^{-2}$. So by Hensel's lemma, $f(x)$ has a root in $\Z_2$.

    Hence $b \in (\Z_p^\times)^2 \iff b \equiv 1 \mod 8$. So $\Z_2^\times/(\Z_2^\times)^2 \equiv (\Z/8\Z)^\times \equiv (\Z/2\Z)^2$. Again, using $\Q_2^\times \cong \Z_2^\times \times \Z$, we find that $\Q_2^\times/(\Q_2^\times)^2 \cong (\Z/2\Z)^3$.
  \end{itemize}
\end{proof}

The proof of Hensel's lemma uses the iteration $x_{n+1} = x_n - \frac{f(x_n)}{f'(x_n)}$, which is the same iteration as used in the Newton-Raphson method for functions on the real numbers. In this case however we can do one better, as Hensel's lemma lets us know when the iteration will converge.

For later applications, we will need the following version of Hensel's lemma:
\begin{theorem}[Hensel's Lemma, version 2]
  Let $(K, \abs{\cdot})$ be a complete discretely valued field, and $f(x) \in \O_K[x]$, and suppose that $\bar{f}(x) \coloneqq f(x) \mod m \in k[x]$ factorises as:
  \begin{align*}
    \bar{f}(x) = \bar{g}(x)\bar{h}(x)
  \end{align*}
  with $\bar{g}(x), \bar{h}(x)$ coprime.

  Then there is a factorisation $f(x) = g(x)h(x)$ in $\O_K[x]$, with $g(x) \equiv \bar{g}(x)\mod m, \bar{h}(x) \equiv h(x) \mod m$, and $\deg \bar{g}= \deg g$.
\end{theorem}
\begin{proof}
  Example sheet 1.
\end{proof}
\begin{corollary}
  Let $f(x) = a_nx^n + \ldots + a_0 \in K[x]$ with $a_0, a_n \neq 0$. If $f(x)$ is irreducible, then $\abs{a_i}\leq \max\{\abs{a_0}, \abs{a_n}\}$ for all $i$.
\end{corollary}
\begin{proof}
  Upon scaling, we may assume $f(x) \in \O_K[x]$ with $\max_i\{\abs{a_i}\} = 1$. Thus we need to show that $\max\{\abs{a_0}, \abs{a_1}\} = 1$. If not, let $r$ be minimal such that $\abs{a_r}=1$, then $0 < r < n$. Thus we have $\bar{f}(x) = x^r(a_r + \ldots a_nx^{n-r}) \mod m$.

  Then \textbf{4.5} tells us this factorisation lifts to a factorisation in $\O_K[x]$, which is a contradiction.
\end{proof}

\section{Teichm\"uller Lifts}
Recall that every element of $\Q_p$ can be written as $x = \sum_{i=n}^\infty a_i p^i$, where \mbox{$a_i \in \{0,\ldots,p-1\}\eqqcolon A$.}

We chose this set $A$ since we found that we needed coset representatives for $\F_p \leq \Z_p$. However, this choice of $A$ doesn't respect any of the algebraic structure on $\Z_p$.

It turns out there is a natural choice of coset representatives in many cases which does respect some algebraic structure.

\begin{definition}
  A ring $R$ of characteristic $p$ is \emph{perfect} if the Frobenius map $\Frob: x \mapsto x^p$ is an automorphism of $R$. A field of characteristic $p$ is perfect if it is perfect as a ring.
\end{definition}
Note that since $\charr R = p, (x+y)^p = x^p + y^p$, so the Frobenius map is a ring homomorphism, so all that is needed is that it is bijective.

\underline{Examples:}
\begin{enumerate}
  \item $\F_p$ and $\bar{\F}_p$ are perfect fields.
  \item $\F_p[t]$ is not perfect - $t \notin \Image(\Frob)$.
  \item $\F_p\left(t^{1/p^\infty}\right) \coloneqq \F_p(t, t^{1/p}, t^{1/p^2}, \ldots)$ is a perfect field. This is the smallest perfect field containing $\F_p(t)$, so we call it the \emph{perfection} of $\F_p(t)$. The $t$-adic absolute value extends to $\F_p(t^{1/p^\infty})$, and the completion of $\F_p(t^{1/p^\infty})$ is called a \emph{perfectoid field}. These were the subject of Peter Scholze's PhD thesis.
\end{enumerate}
Fact: a field $k$ is perfect if and only if any finite extension of $k$ is separable.

\begin{theorem}
  Let $(K, \abs{\cdot})$ be a complete discretely valued field such that $k \coloneqq \O_K/m$ is a perfect field of characteristic $p$. Then there is a unique map \[ [\cdot]:k \to \O_K\] such that:
  \begin{enumerate}
    \item $a \equiv [a] \mod m$ for all $a \in k$.
    \item $[ab] \equiv [a][b]$ for all $a, b \in k$.
  \end{enumerate}
  Moreover, if $\charr \O_K = p$, then $[\cdot]$ is a ring homomorphism.
\end{theorem}
\begin{definition}
  The element $[a] \in \O_K$ constructed in \textbf{5.2} is called the \emph{Teichm\"uller lift} of $a$.
\end{definition}
The idea of the proof of this theorem is that, if $\alpha \in O_K$ be a lift of $a \in k$. $\alpha$ is well defined then up to the ideal $\pi\O_K$ (where $\pi$ is a uniformizer).

Then let $\beta \in \O_K$ be a lift of $a^{1/p}$; we claim that $\beta$ is a ``better" lift:

Let $\beta' \in \O_k$ be another lift of $a^{1/p}$. Then $\beta = \beta' + \pi u, u \in \O_K$, and so $\beta^p = \beta'^p + \sum_{i=1}^\infty \binom{p}{i} \beta'^i(\pi u))^{p-i}$. Since $p \in \pi$, this sum term lies in $\pi^2 \O_K$, and so $\beta$ is well defined up to $\pi^2 \O_K$.

The idea is then to repeat this process, getting a sequence of better and better lifts each time, which will converge to a ``canonical" lift. To do this rigorously we'll need the following lemma:

\begin{lemma}
  Let $(K, \abs{\cdot})$ be as in \textbf{5.3}, and fix $\pi \in\O_K$ a uniformizer. Let $x, y \in \O_K$ such that $x \equiv y \mod \pi^k$, for $k \geq 1$. Then $x^p \equiv y^p \mod \pi^{k+1}$.
\end{lemma}
\begin{proof}
  Let $x = y+u\pi^k$. Then:
  \begin{align*}
    x^p &= \sum_{i=0}^p \binom{p}{i} y^i (u\pi^k)^{p-i}\\
    &= y^p + pu\pi^k y^{p-1} + \sum_{i=2}^p\binom{p}{i}y^i(u\pi^k)^{p-i}\;\;\;\text{for $p>2$}\\
  \end{align*}
  Since $\O_K/\pi\O_K$ is of characteristic $p$, we have $p \in (\pi)$. Thus $pu\pi^ky^{p-1} \in \pi^{k+1}\O_K$. Additionally, for $i \geq 2$, $(u\pi^k)^i \in \pi^{k+1}\O_K$.

  Hence $x^p \equiv y^p \mod \pi^{k+1}$.
\end{proof}
\begin{proof}[Proof of \textbf{Theorem 5.2}.]
  Let $a \in k$. For each $i \geq 0$, we choose a lift $y_i \in \O_K$ of $a^{1/p^i}$, and we define:
  \[x_i \coloneqq y_i^{p^i}\]
  Then $x_i \equiv y_i^{p^i} \equiv\left(a_i^{1/p^i}\right)^{p^i} \equiv a \mod \pi$.

  We then claim that $(x_i)_{i=1}^\infty$ is a Cauchy sequence, and that its limit $x_i \to x$ is independent of the choice of $y_i$.

  By construction, $y_i \equiv y_{i+1}^p \mod \pi$. By \textbf{5.4} and using induction on $k$, we have $y_i^{p^k} \equiv y_{i+1}^{p^{k+1}} \mod \pi^{k+1}$, and hence $x_i \equiv x_{i+1} \mod \pi^{i+1}$, and so the sequence is Cauchy, so converges in $\O_K$ to some $x$.

  Suppose we had chosen different $y_i$s, getting a different sequence $(x_i')_{i=1}^\infty$. Then $x_i' \to x' \in \O_K$.

  Then let $(x_i'')_{i=1}^\infty = \begin{cases} x_i & i \text{ even}\\ x_i' & i \text{ odd}\end{cases}$. Then $(x_i'')$ is also Cauchy, and has convergent subesquences to $x$ and $x'$, so $x=  x'$, and our choice of $y_i$ didn't matter.

  We then define $[a] = x$.

  $x \equiv a \mod \pi$, so the first condition is satisfied.

  For the second condition, let $b \in k$, and we choose $u_i \in \O_K$ a lift of $b^{1/p^i}$; let $z_i \coloneqq u_i^{p^i}$. Then $\lim_{i\to \infty} z_i =[b]$.

  Now $u_iy_i$ is a lift of $(ab)^{1/p^i}$, hence $[ab] = \lim\limits_{i\to\infty} x_i z_i = \lim\limits_{i\to\infty} x_i\lim\limits_{i\to\infty}z_i = [a][b]$.

  If $\charr \O_K = p$, then $y_i + u_i$ is a lift of $a^{1/p^i} + b^{1/p^i} = (a+b)^{1/p^i}$ (raise both sides to $p^i$ and use perfectness $\implies$ bijectivity of $\Frob$). Then we have:
  \begin{align*}
    [a+b] &= \lim_{i\to\infty} (y_i + u_i)^{p^i}\\
    &= \lim_{i\to\infty} y_i^{p^i} + u_i^{p^i}\\
    &= \lim_{i\to\infty} x_i + z_i\\
    &= [a]+[b]
  \end{align*}
  It is easy to check that $[0]=0, [1]=1$, and so $[\cdot]$ is a ring homomorphism.

  For uniqueness, let $\phi : k \to \O_K$ be another such map. Then for $a \in k, \phi(a^{1/p^i})$ is a lift $a^{1/p^i}$. It follows that:
  \[[a] = \lim_{i \to \infty} \phi(a^{1/p^i})^{p^i}=\lim_{i\to\infty} \phi(a) = \phi(a)\]
\end{proof}
\underline{Example:} $K = \Q_p$, then $[\cdot]:\F_p \to \Z_p$. For $a \in \F_p^\times, [a]^{p-1} = [a^{p-1}] = [1] = 1$, and so $[a]$ is a $(p-1)\th$ root of unity. More generally:
\stepcounter{theorem}
\begin{lemma}
  Let $(K, \abs{\cdot})$ be a complete discretely valued field. If $k \coloneqq \O_K/m \subseteq \F_p$, then $[a] \in \O_K^\times$ is a root of unity.
\end{lemma}
\begin{proof}
  $a \in k \implies a \in \F_{p^n}$ for some $n$, so $[a]^{p^n-1} = [1] = 1$.
\end{proof}
\begin{theorem}
  Let $(K, \abs{\cdot})$ be a complete discretely valued field with $\charr K = p > 0$. Then $K \cong k((t))$.
\end{theorem}
\begin{proof}
  Since $K = \Frac(\O_K)$, it suffices to show that $\O_K \cong k[[t]]$. Fix $\pi \in \O_K$ a uniformizer, and let $[\cdot]:k \to \O_K$ be the Teichm\"uller map, and define:
  \begin{align*}
    \varphi: k[[t]] &\to \O_K\\
    \sum_{i=0}^\infty a_i t^i &= \sum_{i=0}^\infty [a_i]\pi^i
  \end{align*}
  Then $\varphi$ is a ring homomorphism since $[\cdot]$ is, and it is a bijection by \textbf{3.5}.
\end{proof}

\section{Extensions of Complete Valued Fields}
\begin{theorem}
  Let $(K, \abs{\cdot})$ be a complete non-archimedean discretely valued field, and $L/K$ a finite extension of degree $n$. Then:
  \begin{enumerate}
    \item $\abs{\cdot}$ extends uniquely to an absolute value $\abs{\cdot}_L$ on $L$, defined by
    \[\abs{y}_L = \abs{N_{L/K}(y)}^{\frac{1}{n}}\forall y \in L\]
    \item $L$ is complete with respect to $\abs{\cdot}_L$.
  \end{enumerate}
\end{theorem}

Recall that if $L/K$ is finite then $N_{L/K}:L \to K$ is defined by $N_{L/K} = \Det_K(\text{mult}_y)$, where $\text{mult}_y$ is the $K$-linear map induced by multiplication by $y$.

We have also that:
\begin{itemize}
  \item $N_{L/K}(xy) = N_{L/K}(x)N_{L/K}(y)$
  \item If $x^n+a_{n-1}x^{n-1} + \ldots + a_0 \in K[x]$ is the minimal polynomial of $y \in L$, then $N_{L/K}(y) = a_0^m$ for some $m \geq 1$.
\end{itemize}

Note that the $n$\th root is not necessary for $\abs{\cdot}_L$ to be an absolute value, but is necessary for it to extend $\abs{\cdot}$, as for $x \in K, N_{L/K}(x) = \Det \diag(x, x, \ldots, x) = x^n$.

We will spend this section proving \textbf{6.1}.

\begin{definition}
  Let $(K, \abs{\cdot})$ be a non-archimedean valued field, and $V$ a vector space over $K$. A norm on $V$ is a function $\norm\cdot : V \to \R_{\geq 0}$ satisfying:
  \begin{enumerate}
    \item $\norm{x} = 0 \iff x = 0$
    \item $\norm{\lambda x} = \abs\lambda\norm{x}\forall \lambda \in K, x \in V$
    \item $\norm{x+y}\leq \max(\norm x, \norm y)$
  \end{enumerate}
\end{definition}

For example, if $V$ is finite dimensional and $e_1, \ldots, e_n$ is a basis of $V$. The $\sup$ norm on $V$ is defined by
\[\norm{x}_{\sup} = \max_i |x_i|\]
where $x = \sum_{i=1}^n x_i e_i$. As an exercise, show $\norm{\cdot}_{\sup}$ is a norm.

\begin{definition}
  Two norms $\norm\cdot_1, \norm\cdot_2$ are equivalent if there are $C, D > 0$ such that
  \[C\norm{x}_1 \leq \norm{x}_2 \leq D \norm{x}_1 \forall x \in V\]
\end{definition}
A norm defines a metric on $V$, and hence a topology, and equivalent norms induce the same topology.
\begin{proposition}
  Let $(K,\abs\cdot)$ be complete and non-archimedean, and $V$ be a finite dimensional vector space over $K$. Then $V$ is complete with respect to $\norm{\cdot}_{\sup}$.
\end{proposition}
\begin{proof}
  Let $(v_i)_{i=1}^\infty$ be a Cauchy sequence in $V$, and let $e_1, \ldots, e_n$ be a basis for $V$. Write $v_1 = \sum_{j=1}^n x_j^i e_j$; then $(x_j^i)_{i=1}^\infty$ is a Cauchy sequence in $K$.

  Let $x_j^i \to x_j \in K$, then $v_i \to v=\sum_{i=1}^n x_j e_j$.
\end{proof}
\begin{theorem}
  Let $(K,\abs\cdot)$ be complete and non-archimedean, and $V$ a finite dimensional vector space over $K$. Then any two norms on $V$ are equivalent. In particular, $V$ is complete with respect to any norm.
\end{theorem}
\begin{proof}
  Since equivalence defines an equivalence relation on a set of norms, it suffices to show that any norm is equivalent to $\norm{\cdot}_{\sup}$.

  Let $e_1, \ldots, e_n$ be a basis for $V$, and set $D \coloneqq \max_i \norm{e_i}$.

  Then for $x = \sum_{i=1}^n x_i e_i$, we have
  \begin{align*}
    \norm{x} &\leq \max_i \norm{x_ie_i}\\
    &= \max_i \abs{x_i}\norm{e_i}\\
    & \leq D\max_i \abs{x_i}\\
    &=D\norm{x}_{\sup}
  \end{align*}

  To find $C$ such that $C \norm{\cdot}_{\sup} \leq \norm\cdot$, we induct on $n =\dim V$.

  If $n = 1$, then $\norm{x} = \norm{x_1 e_1} = \abs{x_1}\norm{e_1}$, so take $C = \norm{e_1}$.

  Then for $n >1$, for each $i$, define $V_i \coloneqq \Span \angle{e_1, \ldots, e_{i-1}, e_{i+1}, \ldots, e_n}$.

  By induction, $V_i$ is complete with respect to $\norm \cdot$ and hence closed. Then $e_i + V_i$ is also closed for all $i$, and hence $S \coloneqq \bigcup\limits_{i=1}^n e_i + V_i$ is a closed subset not containing 0.

  Thus there is $C > 0$ such that $B(0, C)\cap S = \emptyset$.

  Let $x = \sum_{i=1}^n x_i e_i$, and suppose $\abs{x_j} = \max_i \abs{x_i}$. Then $\norm{x}_{\sup} = \abs{x_j}$, and moreover, $\frac{1}{x_j}x \in S$.

  So $\norm{\frac{1}{x_j}x}\geq C, so \norm{x}\geq C\abs{x_j} = C \norm{x}_{\sup}$.

  The completeness of $V$ follows since $V$ is complete with respect to $\norm{\cdot}_{\sup}$.
\end{proof}

\begin{definition}
  Let $R \subseteq S$ be rings. We say $s \in S$ is \emph{integral} over $R$ if there exists a monic polynomial $f(x) \in R[x]$ such that $f(s) = 0$. The \emph{integral closure} $R^{\intt(S)}$ of $R$ inside $S$ is defined to be
  \[ R^{\intt(S)} = \{s \in S : s \text{ integral over }R\}\]

  We say $R$ is integrally closed in $S$ if $R^{\intt(S)} = R$.
\end{definition}
\begin{proposition}
  $R^{\intt(S)}$ is a subring of $S$. Moreover, $R^{\intt(S)}$ is integrally closed in $S$.
\end{proposition}
\begin{proof}
  Example sheet 2.
\end{proof}
\begin{lemma}
  Let $(K, \abs\cdot)$ be a non-archimedean valued field. Then $\O_K$ is integrally closed in $K$.
\end{lemma}
\begin{proof}
  Let $x \in K$ be integral over $\O_K$, and without loss of generality $x \neq 0$.

  Then let $f(x) = x^n+a_{n-1}x^{n-1} + \ldots + a_0 \in \O_K[x]$ such that $f(x) = 0$. Then:
  \[ 1 = -\frac{1}{x}a_{n-1} - a_{n-2} \frac{1}{x^2}-\ldots - a_0\frac{1}{x^n}\]

  If $|x|>1$, we have $1 = \abs{1} = \abs{-\frac{1}{x}a_{n-1}-\ldots-a_0\frac{1}{x^n}} < 1 \contr$.

  But then $\abs{x} \leq 1$, so $x \in \O_K$.
\end{proof}

\begin{proof}[Proof of Theorem 6.1.]
  We show $\abs{\cdot}_L= \abs{N_{L/K}(\cdot)}$ satisfies the three axioms in the definition of absolute values.
  \begin{enumerate}
    \item
    \begin{align*}
      \abs{y}_L = 0 &\iff \abs{N_{L/K}(y)} = 0\\
      &\iff N_{L/K}(y) = 0\\
      &\iff y=0
    \end{align*}
    \item
    \begin{align*}
      \abs{y_1y_2}_L &= \abs{N_{L/K}(y_1y_2)}^{1/n}\\
      &= \abs{N_{L/K}(y_1 y_2)}^{1/n}\\
      &= \abs{N_{L/K}(y_1)N_{L/K}(y_2)}^{1/n}\\
      &= \abs{N_{L/K}(y_1)}^{1/n}\abs{N_{L/K}(y_2)}^{1/n}\\
      &= \abs{y_1}_L \abs{y_2}_L
    \end{align*}
    \item Set $\O_L = \{y \in L : \norm{y}_L \leq 1\}$.
    We then claim that $\O_L$ is the integral closure of $\O_K$ inside $L$.

    To see this let $0 \neq y \in \O_L$, we want to show that $y$ is integral over $\O_K$. Let $f(x) = x^n+a_{n-1} x^{n-1} + \ldots + a_0 \in K[x]$ be the minimal polynomial of $y$. Then there is $m \geq 1$ with $N_{L/K}(y) = a_0^m$.

    By \textbf{4.5}, since $f$ is irreducible, the coefficient with the largest absolute value is either the first or the last in $f$. I.e.:
    \[ \abs{a_i} \leq \max(\abs{N_{L/K}(y)^{1/m}}, 1) = \]

    Now, since $\abs{N_{L/K}(y)} \leq 1$, we have $\abs{a_i} \leq 1$, i.e. $a_i \in \O_K$.

    Hence $f \in \O_K[x]$, and $y$ is integral over $\O_K$.

    Conversely, let $y \in L$ be integral over $\O_K$. Then $N_{L/K}(y) = \left(\prod_{\sigma:L\to \bar{K}} \sigma(y)\right)^d$ for some $d \geq 1$, where $\bar{K}$ is an algebraic closure of $K$ and $\sigma$ runs over all $K$-algebra homomorphisms.

    For all such $\sigma:L \to \bar{K}$, $\sigma(y)$ satisfies the same monic polynomials as $y$, so is also integral over $\O_K$. Thus $N_{L/K}(y) \in K$ is integral over $\O_K$, and hence $N_{L/K}(y) \in \O_K$.

    But then $\abs{N_{L/K}(y)}\leq 1$, and so $y \in \O_L$, so $\O_K^{\intt(L)} = \O_L$, and the claim is proved.

    Now let $x, y \in L$. Without loss of generality, assume that $\abs{x}_L \leq \abs{y}_L$. Then $\abs{\frac{x}{y}}_L \leq 1$, and so $\frac{x}{y} \in \O_L$.

    Since $1 \in \O_L$ and $\O_K^{\intt(L)}$, we have $1 + \frac{x}{y} \in \O_L$, and hence $\abs{1+\frac{x}{y}} \leq 1$, i.e., $\abs{x+y} \leq \abs{y} = \max(\abs{y}_L, \abs{x}_L)$ as required.
  \end{enumerate}

  For uniqueness, suppose $\abs{\cdot}'_L$ is another absolute value on $L$ extending $\abs{\cdot}$, then note that $\abs{\cdot}_L, \abs{\cdot}'_L$ are norms on $L$, hence induce the same topology on $L$, hence are equivalent, hence $\abs{\cdot}_L' = \abs{\cdot}_L^c$ for some $c>0$. Since they agree on $K$, $c = 1$.

  For the completeness part, since $\abs{\cdot}_L$ defines a norm on $K$, \textbf{6.5} implies that $L$ is complete with respect to $\abs{\cdot}_L$.
\end{proof}

\begin{corollary}
  Let $(K, \abs{\cdot})$ be a complete non-archimedean discretely valued field, and $L/K$ a finite extension. Then
  \begin{enumerate}
    \item $L$ is discretely valued with respect to $\abs{\cdot}_L$.
    \item $\O_L$ is the integral closure of $\O_K$ in $L$.
  \end{enumerate}
\end{corollary}
\begin{proof}\hspace*{0cm}
  \begin{enumerate}[label=\textit{\arabic*.}]
    \item Let $v$ be the valuation on $K$, $v_L$ the valuation on $L$ such that $v_L$ extends $v$, and let $n = [L:K]$.

    Then for $y \in L^\times$, $\abs{y}_L = \abs{N_{L/K}(y)}^{1/n}$.

    Hence $v_L(y) = \frac{1}{n}v(N_{L/K}(y))$, and so $v_L(L^\times) \subseteq \frac{1}{n}v(K^\times)$, hence $v_L$ is discrete.

    \item Proved in the previous section.
\end{enumerate}
\end{proof}
\begin{corollary}
  Let $(K, \abs{\cdot})$ be a complete non-archimedean discretely valued field, and $\bar{K}/K$ an algebraic closure of $K$. Then $\abs{\cdot}$ extends to a unique absolute value $\abs{\cdot}_{\bar{K}}$ on $\bar{K}$.
\end{corollary}
\begin{proof}
  Let $x \in \bar{K}$. Then $x$ is algebraic over $K$, so $x \in L$ for some $L/K$ finite. Define $\abs{x}_{\bar{K}} = \abs{x}_L$. This is well defined, i.e. is independent of $L$ by the uniqueness proven in $\textbf{6.1}$. The axioms for $\abs{\cdot}_{\bar{K}}$ to be an absolute value can be checked over finite extensions, as can uniqueness.
\end{proof}
\textsc{N.B.:} $\abs{\cdot}_{\bar{K}}$ is \textit{never} discrete. Take $x \in K, \abs{x} = 1$ (e.g. $p \in \Q_p$). Then for all $n \geq 0, v_{\bar{K}}(\sqrt[n]{x}) = \frac{1}{n}$, which can get arbitrarily close to zero as $x$ has all its roots in $\bar{K}$.

\section{Local Fields}
\begin{definition}
  Let $(K, \abs{\cdot})$ be a valued field. Then we say $K$ is a \emph{local field} if it is complete and locally compact.
\end{definition}
For example, $\R$ and $\C$ are local fields.
\begin{proposition}
  Let $(K, \abs{\cdot})$ be a non-archimedean complete valued field. Then the following are equivalent:
  \begin{enumerate}
    \item $K$ is locally compact.
    \item $\O_K$ is compact.
    \item $v$ is discrete and $k \coloneqq \O_K/m$ is finite.
  \end{enumerate}
\end{proposition}
\begin{proof}\hspace*{0cm}
  \begin{itemize}
    \item[\imp{1}{2}] Let $U \ni 0$ be a compact neighbourhood of $0$. Then $\exists x \in \O_K$ such that $x \O_K \subseteq U$. Since $x \O_K$ is closed, $x\O_K$ is compact, and hence $\O_K$ is compact, as there is a homeomorphism $x\O_K \xrightarrow{x^{-1}} \O_K$.

    \item[\imp{2}{1}] $\O_K$ is compact, so $a+\O_K$ is compact for all $a \in K$, and hence $K$ is locally compact as every $a \in K$ has compact neighbourhood $a+\O_K$.

    \item[\imp{2}{3}] Let $x \in m$, and $A_x \subseteq \O_K$ be a set of coset representatives for $\O_K/x\O_K$.

    Then $\O_K = \bigcup_{y \in A_x} y+x\O_K$, which is a disjoint union of open subsets, and hence an irreducible open cover. So by compactness, $A_x$ is finite. So $\O_K/m$, which is a quotient of $\O_K/x\O_K$, is finite.

    Now suppose that $v$ is not discrete. Let $x = x_1, x_2, x_3, \ldots$ be a sequence such that
    \[ v(x_1)>v(x_2)>v(x_3)>\ldots>0\]
    Then we have
    \[ x\O_K \subsetneq x_2\O_K \subsetneq x_3\O_K \subsetneq\ldots \subsetneq \O_K\]

    But $\O_K/x\O_K$ is finite, so can only have finitely many subgroups as an additive group $\contr$.

    Hence $v$ must be discrete.

    \item[\imp{3}{2}] Since $\O_K$ is a metric space, it suffices to show $\O_K$ is sequentially compact. Let $(x_n)_{n=1}^\infty$ be a sequence in $\O_K$ and fix $\pi \in \O_K$ a uniformizer.

    Then since $\pi^i\O_K/\pi^{i+1}\O_K \cong k, \O_K/\pi^i\O_K$ is finite, as $\O_K \supseteq \pi\O_k \supseteq\ldots\supseteq \pi^i \O_K$, and each quotient is finite, hence the total quotient is finite.

    Since $\O_K/\pi\O_K$ is finite, there is some $a \in \O_K/\pi\O_K$ and a subsequence $(x_{1,n})_{n=1}^\infty$ such that $x_{1,n} \equiv a \mod \pi$.

    Define $y_1 = x_{1,1}$.

    Since $\O_K/\pi^2 \O_K$ is finite, there is some $a_2 \in \O_K/\pi^2 \O_K$ and a subsequence $(x_{2,n})_{n=1}^\infty$ such that $x_{2,n}\equiv a_2 \mod \pi^2 \O_K$.

    Define $y_2 = x_{2,2}$.

    Continuing in this fashion, we get the sequences $(x_{i,n})_{n=1}^\infty$ for $i=1,2,\ldots$, such that $(x_{i+1, n})_{n=1}^\infty$ is a subsequence of $(x_{i,n})_{n=1}^\infty$, and, for any $i$, there is some $a_i \in \O_K/\pi^i\O_K$ with $x_{i,n} \equiv a_i \mod \pi^i$ for all $n$.

    Then necessarily $a_i \equiv a_{i+1} \mod \pi^i$ for all $i$. With $y_i = x_{i,i}$, we have $y_i \equiv y_{i+1} \mod \pi^i$, and so $y_i$ is Cauchy, and hence converges by completeness, and hence $\O_K$ is sequentially compact.
  \end{itemize}
\end{proof}
\underline{Examples:}
\begin{enumerate}
  \item $\Q_p$ is a local field.
  \item $\F_p((t))$ is a local field.
\end{enumerate}
\subsection{More On Inverse Limits}
Let $(A_n)_{n=1}^\infty$ be a sequence of sets/groups/rings and $\varphi_n :A_{n+1}\to A_n$ be homomorphisms.
\begin{definition}
  Assume $A_n$ is finite for all $n$. Then the \emph{profinite topology} on $A \coloneqq \lim\limits_{\xleftarrow[n]{}}A_n$ is the weakest topology on $A$ such that $A \to A_n$ is continuous for all $n$, where $A_n$ are equipped with the discrete topology.
\end{definition}
$A$ with the profinite topology is then compact, totally disconnected, and Hausdorff.

\begin{proposition}
  Let $(K, \abs{\cdot})$ be a local field. Under the isomorphism
  \[ \O_K \cong \lim_{\xleftarrow[n]{}}\O_K/\pi^n\O_K\]
  where $\pi$ is a uniformizer, the topology on $\O_K$ induced via $\abs{\cdot}$ coincides with the profinite topology.
\end{proposition}
\begin{proof}
  Just need to check that, if
  \[\mathcal{B}\coloneqq \{a+\pi^n \O_K : n \in \N_{\geq 1}, a \in A_{\pi^n}\}\]
  where $A_{\pi^n}$ is a set of coset representatives for $\O_K/\pi^n\O_K$, then $\mathcal{B}$ is a basis of open sets in both topologies.

  For $\abs{\cdot}$, this is immediate.

  For the profinite topology, $\O_K \to \O_K/\pi^n \O_K$ is continuous if and only if $a+\pi^n \O_K$ is open for all $a \in A_{\pi^n}$. Then $\mathcal{B}$ is a basis for the profinite topology.
\end{proof}
This gives another proof that $\O_K$ is compact.

\section{Local Fields II}
\begin{lemma}
  Let $K$ be a non-archimedean local field and $L/K$ a finite extension. Then $L$ is a local field.
\end{lemma}
\begin{proof}
  \textbf{6.1} tells us that $L$ is complete and discretely valued, so it suffices to show that $k_L \coloneqq \O_L/m_L$ is finite.

  Let $\alpha_1, \ldots, \alpha_n$ be a basis for $L$ as a $K$-vector space. Then the supremum norm is equivalent to $\abs{\cdot}_L$, and so there is some $r>0$ such that
  \[ \O_L \subseteq \{x \in L : \norm{x}_{\sup}\leq r\}\]
  Take $a \in K$ such that $\abs{a}\geq r$, then:
  \[ \O_L\subseteq \bigoplus_{i=1}^n a\alpha_i \O_K\]
  and so $\O_L$ is finitely generated as an $\O_K$-module, hence the residue field $k_L$ is finitely generated over $k$. Since it is a finite extension of a finite field, $k_L$ is finite, and so $L$ is local.
\end{proof}

\begin{theorem}[Classification of Local Fields]
  Let $K$ be a local field. Then either:
  \begin{enumerate}
    \item $K \cong \R$ or $K \cong \C$
    \item $K$ is a finite extension of $\Q_p$
    \item $K \cong \F_{p^n}((t))$ for $p$ prime, $n\geq1$.
  \end{enumerate}
\end{theorem}
We will aim to prove this over the following few pages.
\begin{definition}
  We say a discretely valued field $(K, \abs{\cdot})$ has \emph{equal characteristic} if $\charr (K) = \charr (k)$. Otherwise we say it has \emph{mixed characteristic}.
\end{definition}

For example, $\charr \Q_p = 0, \charr \F_p = p$, so $\Q_p$ has mixed characteristic. Note that, if $K$ is a local field, $\charr k = p > 0$, and hence $K$ has equal characteristic (respectively mixed) if $\charr K = p$ (respectively $\charr K = 0)$.
\begin{theorem}
  Let $K$ be a local field of equal characteristic $p>0$. Then
  \[K \cong \F_{p^n}((t))\]
  for some $\charr K > 0$.
\end{theorem}
\begin{proof}
  $K$ is complete and discretely valued, with positive characteristic. Moreover, $k \cong \F_{p^n}$ is finite, hence perfect. By \textbf{5.7}, $K \cong \F_{p^n}((t))$.
\end{proof}
\hrule

\subsection{Witt Vectors}
This section is non-examinable.

Consider the ring $\Z_p$. Let $x = \sum_{i=0}^\infty [x_i]_{p^i}, y = \sum_{i=0}^\infty [y_i]p^i$ where $x_i, y_i \in \F_p, x,y \in \Z_p$.

Then, if $x+y = s = \sum_{i=0}^\infty [s_i]p^i$, we might ask if we can write $s_i$ in terms of the $x_j, y_j$.

Reducing mod $p$, we obtain that $x_0+y_0 = s_0 \in \F_p$, so $s_0$ is determined by $x_0, y_0$. What about $s_1$?

Reducing mod $p^2$, $[x_0] + [y_0] + p[x_1] + p[y_1] \equiv [s_0]+ p[s_1] \mod p^2$.

Hence $p[s_1] \equiv ([x_0]+[y_0]-[s_0]) +p[x_1]+p[y_1] \mod p^2$.

So we need to compute $[x_0]+[y_0]-[s_0] \mod p^2$. Note that $[x_0^{1/p}] + [y_0^{1/p}] \equiv [s_0^{1/p}] \mod p$.

By lemma 5.4:
\begin{align*}
  [s_0] &\equiv ([x_0^{1/p}]+[y_0^{1/p}])^p \mod p^2\\
  &\equiv [x_0]+[y_0] + \sum_{d=1}^{p-1}\binom{p}{d}[x_0^{d/p}][y_0^{(p-d)/p}] \mod p^2
\end{align*}
Hence $s_1$ is determined by $x_0, y_0, x_1, y_1$. This can be continued in a similar pattern for $s_2, s_3, \ldots$. Witt noticed the general pattern:
\begin{definition}
  The $n\th$ \emph{Witt polynomial} $w_n$ is defined by:
  \[w_n(x_0, x_2, \ldots, x_n) = \sum_{i=0}^n p^i x^{p^{n-i}} \in \Z[x_0, x_1, \ldots, x_n]\]
\end{definition}
Define $S_n \in \Q[x_0, y_0, \ldots, x_n, y_n]$ inductively by
\[w_n(S_0, \ldots, S_n) = w_n(x_0, \ldots, x_n) + w_n(y_0, \ldots, y_n)\]
Witt showed that $S_n \in \Z[x_0, y_0, \ldots, x_n, y_n]$.
E.g.
\begin{itemize}
  \item $S_0 = x_0+y_0$
  \item $S_1 = x_1+y_1 + \sum_{d=1}^{p-1}\frac{1}{p}\binom{p}{d}x_0^d y_0^{p-d}$
\end{itemize}
\begin{theorem}
  Suppose that
  \[ \sum_{i=0}^\infty [x_i]p^i + \sum_{i=0}^\infty [y_i]p^i = \sum_{i=0}^\infty [s_i]p^i \in \Z_p\]
  Then we have $s_n = S_n(x_0^{1/p^n}, y_0^{1/p^n}, x_1^{1/p^{n-1}}, y_1^{1/p^{n-1}}, \ldots, x_n, y_n)$.
\end{theorem}
\begin{proof}
  Example sheet 2. Hint: Use lemma \textbf{5.4}.
\end{proof}
Similarly, define $Z_n \in \Q[x_0, y_0, \ldots, x_n, y_n]$ by
\[w_n(Z_0, \ldots, Z_n) = w_n(x_0, \ldots, x_n)w_n(y_0, \ldots, y_n)\]
Then again Witt showed $Z_n \in \Z[x_0,\ldots, x_n]$, and that
\[\sum_{i=0}^\infty [x_i]p^i \sum_{i=0}^\infty [y_i]p^i = \sum_{i=0}^\infty [z_i]p^i\]
where $z_n = Z_n(x_0^{1/p^n}, y_0^{1/p^n}, \ldots, x_n, y_n)$.

Conclusion: the ring structure on $\Z_p$ can be reconstructed from the arithmetic of $\F_p$.

\begin{definition}
  A ring $A$ is a strict $p$-ring if it is $p$-adically complete, $p$ is not a zero divisor in $A$, and $A/pA$ is a perfect ring of characteristic $p$.
\end{definition}
\begin{theorem}[Existence of Witt vectors]
  Let $R$ be a perfect ring of characteristic $p$.
  \begin{enumerate}
    \item There exists a strict $p$-ring $W(R)$ called the \emph{Witt vectors} of $R$ such that $W(R)/pW(R) \cong R$, which is unique up to isomorphism.
    \item If $R'$ is another perfect ring and $f:R\to R'$ is a ring homomorphism, then there is a unique homomorphism $F:W(R)\to W(R')$ such that following diagram commutes
    \begin{center}
      \begin{tikzcd}
        W(R) \arrow{r}{F} \arrow{d} & W(R')\arrow{d} \\ R \arrow{r}{f} & R'
      \end{tikzcd}
    \end{center}
  \end{enumerate}
\end{theorem}
$W(R)$ is sort of a mixed-characteristic analogue of $R[[t]]$, where $p$ plays the role of $t$. (E.g. note that $R[[t]]/(t) \cong R$.)
\begin{proof}[Sketch proof.]
  For a detailed proof, see Rabinoff: The Theory of Witt Vectors.

  \begin{enumerate}[label=\textit{\arabic*.}]
    \item Define $W(R) = \{ (a_i)_{i=0}^\infty : a_i \in R\}$, and define addition and multiplication by:
    \begin{align*}
      (a_n)_{n=0}^\infty + (b_n)_{n=0}^\infty &= (s_n)_{n=0}^\infty\\
      (a_n)_{n=0}^\infty (b_n)_{n=0}^\infty &= (z_n)_{n=0}^\infty
    \end{align*}
    where $s_n = S_n(a_0, \ldots, b_n), z_n = Z_n(a_0, \ldots, b_n)$ are as above.

    Check that this defines a ring structure. For $a = (a_0, a_1, \ldots) \in W(R)$, then $pa = (0, a_0^p, a_1^p, \ldots)$, and so $p$ is not a zero divisor.

    Moreover, $W(R)/p^iW(R) = \{(a_n)_{n=0}^{i}:a_n \in R\}$, the sequences of length $i$. We then compute explicitly $W(R) \cong \lim\limits_{\xleftarrow[i]{}}W(R)/p^iW(R)$.

    \item For $f: R\to R'$, define $F:W(R)\to W(R')$ by $F[a_0, a_1, \ldots] = (f(a_0), f(a_1), \ldots) \in W(R')$, and check this works.
  \end{enumerate}
\end{proof}

If $R = \F_p$, then $W(\F_p) \cong \Z_p$, and the isomorphism is given by
\[(a_0, a_1, \ldots) \mapsto \sum_{i=0}^\infty \left[a_i^{1/p^i}\right]p^i\]

\begin{proposition}
  Let $(K, \abs{\cdot})$ be a complete discretely valued field such that $p \in \O_K$ is a uniformizer and $k \coloneqq \O_K/m$ is perfect. Then $\O_K \cong W(k)$.
\end{proposition}
\begin{proof}
  By uniqueness of $W(k)$, it suffices to prove that $\O_K$ is a strict $p$-ring. This is clear from properties of $\O_K$.
\end{proof}

If $k$ is a perfect field, $K = \Frac(W(k))$, then $K$ is a complete discretely valued field with $\O_K \cong W(K)$ and $p \in \O_K$ is a uniformizer, so in fact the converse of the above proposition holds.

\begin{proposition}
  Let $(K, \abs{\cdot})$ be a complete discretely valued field with $k \coloneqq \O_K/m$ perfect, then $\O_K$ is finite over $W(k)$.
\end{proposition}
\begin{proof}
  Consider the subset $R \subseteq \O_K$ defined by $R = \{\sum_{i=0}^\infty [a_i]p^i : a_i \in k\}$. Calculating as in the example of $\Z_p$ shows that $R \cong W(k)$. Let $\pi$ be a uniformizer in $\O_K$ and let $e \in \N$ such that $ev(\pi) = v(p)$.

  Let $M = \bigoplus\limits_{i=0}^\infty \pi^i R \subseteq \O_K$, an $R$-submodule.

  Since $\sum_{n=0}^\infty [x_n]\pi^n \equiv \sum_{n=0}^{e-1}[x_n]\pi^n \mod p\O_K$, and so $M$ generates $\O_K$ modulo $p\O_K$ as an $R$-module.

  Hence $\O_K = M+p\O_K$.

  Iterating, $\O_K = M+pM+p^2M + \ldots + p^m\O_K = M+p^m \O_K$, and so $M \to \O_K/p^m\O_K$ is surjective for all $m$.

  Using the fact that $M \cong \lim\limits_{\xleftarrow[n]{}} M/p^nM$, we can show that $M \to \O_K$ is surjective, and so $M = \O_K$.
\end{proof}

\begin{theorem}
  Let $K$ be a non-archimedean local field of mixed characteristic. Then $K$ is a finite extension of $\Q_p$.
\end{theorem}
\begin{proof}
  Let $k = \F_{p^n}$ for some primes $p$. Then by $\textbf{8.10}$, $K$ is a finite extension of $\Frac(W(\F_{p^n}))$. It suffices to show that $W(\F_{p^n})$ is finite over $\Z_p$.

  Let $e_1, \ldots, e_n \in \F_{p^n}$ be a basis of $\F_{p^n}$ as an $\F_p$ vector space, and we write
  \[M \coloneqq \bigoplus_{i=1}^n W(\F_p)[e_i] \subseteq W(\F_{p^n})\]
  which is a $W(\F_p)$ submodule.

  For $x = \sum_{i=0}^\infty [x_i]p^i \in W(\F_{p^n})$, let $x_0 = \sum_{i=1}^\infty \lambda_i e_i$ for $\lambda \in \F_p$.

  Then $x - \sum_{i=1}^\infty [\lambda_i][e_i] \in pW(\F_{p^n})$, and so $W(\F_{p^n}) = M+pW(\F_{p^n})$.

  Arguing as in the previous proposition shows that $M = W(\F_{p^n})$.
\end{proof}
End of non-examinable content.\\
\hrule
\section{Archimedean Local Fields}
\begin{lemma}
  An absolute value $\abs{\cdot}$ on a field is non-archimedean if and only if $|n|$ is bounded for all $n \in \Z$.
\end{lemma}
\begin{proof}
  For the forwards direction, since $\abs{-1} = 1, \abs{-n}=\abs{n}$, it suffices to show that $\abs{n}$ is bounded for $n \geq 1$. By the ultrametric inequality, $\abs{n} = \abs{1+1+\ldots+1} \leq 1$.

  For the other direction, suppose $\abs{n} \leq B$ for all $n \in \Z$. The let $x, y \in K$ with $\abs{x}\leq \abs{y}$. Then $\abs{x+y}^m = \abs{\sum_{i=0}^m \binom{m}{i}x^i y^{m-i}} \leq \sum_{i=0}^m \abs{\binom{m}{i}x^iy^{m-i}}\leq B(m+1)\abs{y}^m$.

  Taking $m\th$ roots, $\abs{x+y} \leq \abs{y}[B(m+1)]^{1/m} \to \abs{y} = \max(\abs{x}, \abs{y})$ as $m \to \infty$.
\end{proof}
\begin{corollary}
  If $(K,\abs{\cdot})$ is a valued field of positive characteristic, then $K$ is non-archimedean.
\end{corollary}
\begin{proof}
  Given the homomorphism $\phi:\Z \to K; 1 \mapsto 1$, we have $\phi(\charr K) = 0$, and hence $\{\phi(n): n \in \Z\}$ is finite, so $\abs{n}$ bounded for $n \in \Z$. Then apply \textbf{9.1}.
\end{proof}
\begin{theorem}[Ostrowski's Theorem]
    Any non-trivial absolute value on $\Q$ is equivalent to either $\abs{\cdot}_\infty$ or $\abs{\cdot}_p$ for some prime $p$.
\end{theorem}
\begin{proof}
  We split the proof into the archimedean and non-archimedean cases.

  \begin{itemize}
    \item \underline{Archimedean}

    We fix $b > 1$ an integer such that $\abs{b} > 1$, which exists by \textbf{9.1}. Let $a > 1$ be an integer and write $b^n$ in base $a$:
    \[ b^n = c_ma^m + c_{m-1}a^{m-1} + \ldots + c_0\]
    where $0 \leq c_i < a$. Now let $B = \max_{0\leq c<a}(|c|)$, then we have
    \begin{align*}
      \abs{b^n} &\leq (m+1)B\max(\abs{a}^m ,1)\\
      \abs{b} &\leq [(n(\log_a b)+1)B]^{1/n} \max(\abs{a}^{\log_a b}, 1)\\
      \abs{b} &\leq \max(\abs{a}^{\log_a b}, 1)
    \end{align*}
    Then $\abs{a} > 1$, and $\abs{b} \leq \abs{a}^{\log_a b}$. Switching the roles of $a$ and $b$, we get $\abs{a} \leq \abs{b}^{\log_b a}$.

    Hence $\frac{\log \abs{a}}{a} = \frac{\log \abs{b}}{b} = \lambda > 0$ say, and $\abs{a} = a^\lambda$ for all $a \in \Z$. But then $\abs{x} = \abs{x}_\infty^\lambda$ for any $x \in \Q$, and so $\abs{\cdot}$ is equivalent to $\abs{\cdot}_\infty$.

    \item \underline{Non-archimedean}

    As in \textbf{9.3}, we have $\abs{n}\leq 1$ for all $n \in \Z$. Since $\abs{\cdot}$ is non-trivial, there is some $n \in \Z_{>1}$ such that $\abs{n} < 1$.

    Write $n = p_1^{e_1}\ldots p_r^{e_r}$ as a decomposition into prime factors. Then $\abs{p} <1$ for some $p \in \{p_1, \ldots, p_r\}$.

    Suppose that $\abs{q} < 1$ for some prime $q \neq p$.

    Then $q = rp+sq$ for $r, s \in \Z$, and $1 = \abs{1} = \abs{rp+sq} \leq \max{\abs{rp}, \abs{sq}} < 1$. So $p$ is the only prime with absolute value less than $1$, and has absolute value $\alpha < 1$. But then using multiplicativity and unique prime factorisation, $\abs{\cdot}$ is equivalent to $\abs{\cdot}_p$.
  \end{itemize}
\end{proof}
\begin{theorem}
  Let $(K, \abs{\cdot})$ be an archimedean local field. Then $K = \R$ or $\C$ and $\abs{\cdot}$ is equivalent to $\abs{\cdot}_\infty$.
\end{theorem}
\begin{proof}
  If $\charr K > 0$, then $K$ is non-archimedean by \textbf{9.2}, so we only need to deal with characteristic 0. So $\Q \subseteq K$.

  Since $\abs{\cdot}$ is archimedean, the restriction of $\abs{\cdot}$ to $\Q$ must be equivalent to $\abs{\cdot}_\infty$ by Ostrowski. Since $K$ is complete, $\R \subseteq K$.

  We first consider the case when $\C \subseteq K$. By uniqueness of extensions of absolute values, $\abs{\cdot}$ when restricted to $\C$ is equivalent to $\abs{\cdot}_\infty$.

  Suppose that $\alpha \in K \setminus \C$. Then $f(x)=\abs{x-\alpha}$ is a continuous function on $\C$ and hence attains a lower bound at $b \in \C$.

  Set $\beta = \alpha - b \neq 0$, and we let $c \in \C$ such that $0<\abs{c}<\abs{\beta}$.

  Then $\abs{\beta-a} \geq \abs{\beta}$ for any $a \in \C$. Then
  \begin{align*}
    \frac{\abs{\beta-c}}{\abs{\beta}} \leq \frac{\abs{\beta-c}}{\abs{\beta}} \prod_{\substack{\zeta^n = 1\\\zeta\neq 1}} \frac{\abs{\beta-\zeta c}}{\abs{\beta}} \\
    &= \frac{\abs{\beta^n-c^n}}{\abs{\beta}^n}\\
    &=\abs{1-\left(\frac{c}{\beta}\right)^n}\\
    &\to 1 \text{ as } n \to \infty
  \end{align*}
  So $\abs{\beta-c}\leq \abs{\beta}$, and hence $\abs{\beta-c} = \abs{\beta}$.

  Replace $\beta$ by $\beta-c$ and iterating, we obtain $\abs{\beta-mc} = \abs{\beta}$ for all $m \in \N$.

  But then $\abs{m}\abs{c} = \abs{mc} \leq \abs{\beta-mc}+\abs{beta} = 2\abs{\beta}$, and so $\abs{\cdot}$ must be non-archimedean by \textbf{9.1} $\contr$, and hence $K = \C$.

  Now suppose that $\C \nsubseteq K$. Define $L = K(\im)$ where $\im^2 = -1$. We can extend $\abs{\cdot}$ to an absolute value $\abs{\cdot}_L$ on $L$ given by $\abs{a+\im b}_L = \sqrt{\abs{a}^2 + \abs{b}^2}$ for $a, b \in K$.

  Applying the above argument gives $K(\im) = L = \C$, and hence $K = \R$.
\end{proof}
We are now ready to finish the classification of local fields.
\begin{proof}[Proof of \textbf{Theorem 8.2}.]\hspace*{0cm}\\
  If $\abs{\cdot}$ is archimedean, use \textbf{9.4}.

  If $\abs{\cdot}$ is non-archimedean with characteristic 0, use \textbf{8.11}.

  If $\abs{\cdot}$ is non-archimedean with positive characteristic, use \textbf{8.4}.
\end{proof}
\section{Global Fields}
\begin{definition}
  A \emph{global field} is a field which is either:
  \begin{itemize}
    \item An algebraic number field - a finite extension of $\Q$.
    \item A global function field - the rational function field of an algebraic curve over a finite field. Equivalently, they are finite extensions of $\F_p(t)$.
  \end{itemize}
\end{definition}
In this course, we will mainly focus on the number field case.

We will show that local fields are completions of global fields.
\begin{lemma}
  Let $(K, \abs{\cdot})$ be a complete discretely valued field, $L/K$ a Galois extension, and $\abs{\cdot}_L$ the unique extension of $\abs{\cdot}$ to $L$.

  Then for $x \in L, \sigma \in \Gal(L/K)$, we have $\abs{\sigma(x)}_L = \abs{x}_L$.
\end{lemma}
\begin{proof}
  Since $x \mapsto \abs{\sigma(x)}_L$ is another absolute value on $L$ extending $\abs{\cdot}$ on $K$. Hence by uniqueness, $\abs{x}_L = \abs{\sigma(x)}_L$.
\end{proof}
\begin{lemma}[Krasner's Lemma]
  Let $(K, \abs{\cdot})$ be a complete discretely valued field. Let $f(x) \in K[x]$ be a separable irreducible polynomial with roots $\alpha_1, \ldots, \alpha_n$ in $\bar{K}$, a separable algebraic closure of $K$.

  Suppose $\beta \in \bar{K}$ with
  \[\abs{\beta-\alpha_1} <\abs{\beta-\alpha_i}\text{ for } i=2,\ldots, n\]
  Then $\alpha_1 \in K(\beta)$.
\end{lemma}
\begin{proof}
  Let $L = K(\beta), L'=L(\alpha_1, \ldots, \alpha_n)$. Since $L'$ is the splitting field of a separable polynomial, $L'/L$ is Galois. Let $\sigma \in \Gal(L'/L)$. Then, since $\sigma(\beta)=\beta$, $\abs{\beta-\sigma(\alpha_1)} = \abs{\sigma(\beta-\alpha_1)} = \abs{\beta-\alpha_1}$.

  So $\sigma(\alpha_1)=\alpha_1$ for all $\sigma \in \Gal(L'/L)$. But then $\alpha \in L = K(\beta)$.
\end{proof}
\begin{proposition}[Nearby polynomials define the same extension]
  Let $(K, \abs{\cdot})$ be a complete discretely valued field, and $f(x) = \sum_{i=0}^n a_i x^i \in \O_K[x]$ be a separable irreducible monic polynomial.

  Let $\alpha \in \bar{K}$ be a root of $f$. Then there is some $\epsilon > 0$ such that, for any $g(x) = \sum_{i=0}^n b_ix^i \in \O_K[x]$ monic, with $\abs{a_i-b_i} < \epsilon$, there exists a root $\beta$ of $g(x)$ such that $K(\alpha)=K(\beta)$.
\end{proposition}
\begin{proof}
  Let $\alpha = \alpha_1, \ldots, \alpha_n \in \bar{K}$ be the roots of $f$ which are necessarily distinct. Then $f'(\alpha) \neq 0$.

  Choose $\epsilon$ sufficiently small so that
  \begin{align*}
    \abs{g(\alpha_1)} &< \abs{f'(\alpha_1)}^2\\
    \abs{f'(\alpha_1)-g'(\alpha_1)} &< \abs{f'(\alpha_1)}
  \end{align*}
  Then we have $\abs{g(\alpha_1)} < \abs{f'(\alpha_1)}^2 = \abs{g'(\alpha_1)}^2$.

  By Hensel's lemma applied to the field $K(\alpha_1)$, there is some $\beta \in K(\alpha_1)$ with $g(\beta) = 0$ and $\abs{\beta-\alpha_1} < \abs{g'(\alpha)}$.

  Since $\abs{g'(\alpha)} = \abs{f'(\alpha)} = \prod_{i=2}^n \abs{\alpha_1-\alpha_i} \leq \abs{\alpha_1-\alpha_i}$ for $i=2, \ldots, n$, since $\abs{\alpha_1-\alpha_i} \leq 1$, as all roots lie in $\O_{\bar{K}}$.

  Since $\abs{\beta-\alpha_1} < \abs{g'(\alpha_1)} = \abs{f'(\alpha_1)} \leq \abs{\alpha_1-\alpha_i} = \abs{\beta-\alpha_i}$, and by Krasner's lemma we have $K(\alpha) = K(\beta)$.
\end{proof}
\begin{theorem}
  Let $K$ be a local field. Then $K$ is the completion of a global field.
\end{theorem}
\begin{proof}
  We split into cases:
  \begin{enumerate}
    \item \underline{$\abs{\cdot}$ is archimedean}

    Then $\R$ is the completion of $\Q$ with respect to $\abs{\cdot}_\infty$, and $\C$ is the completion of $\Q(i)$ with respect to $\abs{\cdot}_\infty$.

    \item \underline{$K$ non-archimedean and has equal characteristic}

    Then $K \cong \F_q((t))$, and $K$ is the completion of $F_q(t)$ with respect to the $t$-adic absolute value.

    \item \underline{$K$ non-archimedean and has mixed characteristic}

    Then $K \cong \Q_p(\alpha)$ for $\alpha$ a root of monic irreducible polynomial over $\Z_p$.

    Since $\Z$ is dense in $\Z_p$, we can choose $g(x) \in \Z[x]$ as in \textbf{10.4}. Then $K = \Q_p(\beta)$ where $\beta$ is a root of $g$. Since $\beta \in \bar{\Q}$, we have $\Q(\beta) \subseteq \Q_p(\beta) = K$. So $K$ is the completion of $\Q(\beta)$.
  \end{enumerate}
\end{proof}
\subsection{Dedekind Domains}
The global analogue of a discrete valuation ring is a Dedekind domain.
\begin{definition}
  A \emph{Dedekind domain} is a ring $R$ such that:
  \begin{enumerate}
    \item $R$ is a Noetherian integral domain.
    \item $R$ is integrally closed in $\Frac(R)$.
    \item Every non-zero prime ideal is maximal.
  \end{enumerate}
\end{definition}
\underline{Examples:}
\begin{itemize}
  \item The ring of integers in a number field is a Dedekind domain.
  \item Any PID (hence DVR) is a Dedekind domain.
\end{itemize}
\begin{theorem}
  A ring $R$ is a DVR if and only if $R$ is a Dedekind domain with exactly one non-zero prime ideal.
\end{theorem}
\begin{lemma}
  Let $R$ be a Noetherian ring and $I \subseteq R$ a non-zero ideal. Then there exists non-zero prime ideals $p_1, \ldots, p_r \subseteq R$ such that $p_1p_2\ldots p_r \subseteq I$.
\end{lemma}
\begin{proof}
  Suppose not. Since $R$ is Noetherian, we can choose $I$ maximal with this property. Then $I$ is not prime, so there exists $x, y \in R\setminus I$ such that $xy \in I$.

  Let $I_1 = I+(x), I_2 = I+(y)$. Then by maximality of $I$, there are $p_1, \ldots, p_r, q_1, \ldots, q_s$ prime ideals such that $p_1\ldots p_r \subseteq I_1; q_1\ldots q_s \subseteq I_2$.

  But then $p_1\ldots p_rq_1\ldots q_s \subseteq I_1I_2 = I \contr$.
\end{proof}

\begin{lemma}
  Let $R$ be an integral domain which is integrally closed in $K = \Frac(R)$. Let $I \subseteq R$ be a non-zero finitely generated ideal and $x \in K$. Then if $xI \subseteq I$, we have $x \in R$.
\end{lemma}
\begin{proof}
  Let $I = (c_1, \ldots, c_n)$. We write $xc_i = \sum_{i=1}^n a_{ij}c_i$ for some $a_{ij} \in R$. Let $A$ be the matrix $A = (a_{ij})_{1\leq i,j\leq n}$, and $B = x\text{Id}_n - A \in M_{n\times n}(K)$.

  Let $\text{Adj}(B)$ be the adjugate matrix for $B$.

  Then $B \begin{pmatrix}c_1\\\vdots\\c_n\end{pmatrix} = 0$ in $K^n$. Multiplying both sides by $\text{Adj}(B)$, we get:
  \[(\det B)\text{Id}_n\begin{pmatrix} c_1\\\vdots\\ c_n\end{pmatrix} = 0\]
  and so $\det B = 0$. But $\det B$ is a monic polynomial in $x$ with coefficients in $R$. So $x$ is integral over $R$, and hence $x \in R$.
\end{proof}
\begin{proof}[Proof of \textbf{10.7}]
  The forwards direction is immediate.

  For the reverse direction, we need to show that $R$ is a $PID$. The assumption implies that $R$ is a local ring with unique maximal ideal $m$.

  \underline{Step 1: $m$ is principal.}

  Let $0 \neq x \in m$. By \textbf{10.7}, $(x) \supseteq m^n$ for some $n \geq 1$. Let $n$ be minimal such, then we may choose $y \in m^{n-1}\setminus (x)$.

  Set $\pi \coloneqq \frac{x}{y}$. Then $ym \subseteq m^n \subseteq (x)$, and so $\pi^{-1}m \subseteq R$.

  If $\pi^{-1}m \subseteq m$, then $\pi^{-1} \in R$ by \textbf{10.8}, and so $y \in (x)\contr$.

  Hence $\pi^{-1}m =R$, since $m$ is the unique maximal ideal and so any elements not in $m$ are units.

  So $m = \pi R$ is principal.

  \underline{Step 2: $R$ is a PID.}

  Let $I \subseteq R$ be a non-zero ideal. Consider the sequence of ideals
  \[ I \subseteq \pi^{-1}I \subseteq \pi^{-2} I \subseteq \ldots \text{ in $K$}\]
  Then $\pi^{-k}I \neq \pi^{-(k+1)}I$ for all $k$, by \textbf{10.9}, and so the inclusions are strict. Since $R$ is Noetherian, we may choose a maximal $n$ such that $\pi^{-n}I \subseteq R$.

  If $\pi^{-n}I \subseteq m = (\pi)$, then $\pi^{-(n+1)} I \subseteq R\contr$.

  Thus $\pi^{-n}I = R$, and hence $I = (\pi^n)$.
\end{proof}

\section{Dedekind Domains II}
Let $R$ be an integral domain, and $S \subseteq R$ a multiplicatively closed subset. Then the \emph{localisation of R with respect to S}, $S^{-1}R$ is the ring
\[S^{-1}R \coloneqq \left\{\frac{r}{s} : r \in R, s \in S\right\}\subseteq \Frac(R)\]
If $p$ is a prime ideal in $R$, we write $R_{(p)}$ for the localisation with respect to $S = R\setminus p$.

\underline{Examples:}
\begin{itemize}
  \item $p = (0), R_{(p)} = \Frac(R)$
  \item $R = \Z, \Z_{(p)} = \left\{\frac{a}{p^n}:a \in \Z, n \geq 0 \right\}$
\end{itemize}
If $R$ is noetherian, then $S^{-1}R$ is also noetherian. There is always a bijection
\[\{\text{prime ideals in }S^{-1}R\} \leftrightarrow \{\text{prime ideals }p\subseteq R\st p\cap S =\emptyset\}\]
given by $pS^{-1}R \leftrightarrow p$.

\begin{corollary}
  Let $R$ be a Dedekind domain, and $p \subseteq R$ a non-zero prime. Then $R_{(p)}$ is a DVR.
\end{corollary}
\begin{proof}
  By properties of localisation, $R_{(p)}$ is a noetherian integral domain with a unique non-zero prime ideal $p R_(p)$. It suffices to show $R_{(p)}$ is also integrally closed in $\Frac(P_{(p)}) = \Frac(R)$, since then $R_{(p)}$ will be a Dedekind, and so by \textbf{10.7} is a DVR.

  Let $x \in \Frac(R)$ be integral over $R_{(p)}$. Multiplying by denominators of a monic polynomial satisfied by $x$, we obtain
  \[sx^n + a_{n-1}x^{n-1}+\ldots+a_0 = 0, a_i \in R, s \in S\]
  Multiplying by $s^{n-1}$ we get that $xs$ is integral over $R$, so $xs \in R$ as $R$ is a Dedekind domain, so $x \in R_{(p)}$.
\end{proof}
\begin{definition}
  If $R$ is a Dedekind domain, and $p \subseteq R$ a non-zero prime ideal, then we write $v_p$ for the normalised valuation on $\Frac(R) = \Frac(R_{(p)})$ corresponding to the DVR $R_{(p)}$.
\end{definition}
For example, if $R = \Z, p = (p), v_p$ is the $p$-adic valuation on $\Z$.
\begin{theorem}
  Let $R$ be a Dedekind domain. Then every non-zero prime ideal $I \subseteq R$ can be written uniquely as a product of prime ideals:
  \[I = p_1^{e_1}\ldots p_r^{e_r}, p_i \text{ distinct}\]
\end{theorem}
Note that this is clear for PIDs, as they are UFDs.
\begin{proof}
  We will quote the following properties of localisations:
  \begin{enumerate}
    \item If $I\nsubseteq p$ then $IR_{p} \subsetneq pR_{(p)}$.
    \item $I=J \iff IR_{(p)} = JR_{(p)} \forall p$ prime ideals.
  \end{enumerate}
  Let $I \subseteq R$ be a non-zero ideal. Then by \textbf{10.8}, there are prime ideals $p_1, \ldots, p_r$ such that $p_1^{\beta_1}\ldots p_r^{\beta_r} \subseteq I$, where $\beta_i >0$.

  Then $IR_{(p)} = \begin{cases} R_{(p)} & p \notin \{p_1, \ldots, p_r\}\\p^{\alpha_i}R_{(p)} & p=p_i \end{cases}$

  Here $0 \leq \alpha_i, \beta_i$, the second case follows from \textbf{11.1}.

  Then $I = p_1^{\alpha_1}\ldots p_r^{\alpha_r}$ by the second quoted property.

  For uniqueness, if $I = p_1^{\alpha_1}\ldots p_r^{\alpha_r} = p_1^{\gamma_1}\ldots p_r^{\gamma_r}$, then $p_i^{\alpha_i}R_{(p_i)} = p_i^{\gamma_i}R_{(p_i)}$, and so $\alpha_i =\gamma_i$ by unique factorisation in DVRs.
\end{proof}
\subsection{Dedekind Domains and Extensions}
Let $L/K$ be a finite extension. Then for $x \in L$, we write $\Tr_{L/K}(x) \in K$ for the \emph{trace} of the $K$-linear map given by multiplication by $x$.

If $L/K$ is separable and $\sigma_1, \ldots, \sigma_n : L \to \bar{K}$ denotes the set of embeddings of $L$ into a separable closure $\bar{K}$, then
\[ \Tr_{L/K}(x) = \sum_{i=1}^n \sigma_i(x)\]
\begin{lemma}
  Let $L/K$ be a finite separable extension of fields. Then the symmetric bilinear pairing
  \[(\cdot,\cdot):L\times L \to K; (x, y)\mapsto \Tr_{L/K}(xy)\]
  is non-degenerate.
\end{lemma}
\begin{proof}
  By the primitive element theorem, $L = K(\alpha)$ for some $\alpha \in L$. We consider the matrix $A$ for $(\cdot,\cdot)$ in the $K$-basis for $L$ given by $1, \alpha, \alpha^2, \ldots, \alpha^{n-1}$. Then:
  \[A_{ij} =\Tr_{L/K}(\alpha^{i+j}) = [B^2]_{ij}\]
  where $B$ is the $n\times n$ Vandermonde matrix with
  \[B = \begin{pmatrix}1 & 1 & \cdots & 1\\\sigma_1(\alpha) & \sigma_2(\alpha) & \cdots & \sigma_n(\alpha) \\ \vdots & \vdots & & \vdots \\ \sigma_1(\alpha^{n-1}) & \sigma_2(\alpha^{n-1}) & \cdots & \sigma_n(\alpha^{n-1})\end{pmatrix}\]
  Then $\det A = (\det B)^2 = \left[\prod\limits_{1\leq i < j \leq n} (\sigma_i(\alpha)-\sigma_j(\alpha))\right]^2 \neq 0$, since $\sigma_i(\alpha)\neq \sigma_j(\alpha)$ for $i \neq j$.
\end{proof}
In fact, a finite extension of fields $L/K$ is separable if and only if the trace form in non-degenerate.

\begin{theorem}
  Let $\O_K$ be a Dedekind domain and $L$ a finite separable extension of $K = \Frac(\O_K)$. Then the integral closure $\O_L$ of $\O_K \in L$ is a Dedekind domain.
\end{theorem}
\begin{proof}
  Since $\O_L \subseteq L$, it is an integral domain. We need to show that:
  \begin{enumerate}
    \item $\O_L$ is noetherian.
    \item $\O_L$ is integrally closed in $L$.
    \item Every non-zero prime ideal $P \subseteq \O_L$ is maximal.
  \end{enumerate}
  We'll check these in order:
  \begin{enumerate}
    \item Let $e_1, \ldots, e_n \in L$ be a $K$-basis for $L$. Upon scaling by $K$, we may assume that $e_i \in \O_L$. Let $f_i \in L$ be the dual basis with respect to the trace form $(\cdot, \cdot)$.

    Let $x \in \O_L$ and write $x = \sum_{i=1}^n \lambda_i f_i$ for $\lambda_i \in K$. Then $\lambda_i = \Tr_{L/K}(xe_i) \in \O_K$, as for any $z \in \O_L, \Tr_{L/K}(z)$ is a sum of elements which are integral over $\O_K$, and so $\Tr_{L/K}(z)$ is integral over $\O_K$, hence in $\O_K$ as $\O_K$ is Dedekind.

    Thus $\O_L \subseteq \O_K f_1 + \ldots + \O_K f_n$.

    Since $\O_K$ is noetherian, $\O_L$ is finitely generated as an $\O_K$-module, and so $\O_L$ is noetherian.
    \item Example sheet 2.
    \item Let $\mathcal{P}$ be a non-zero prime ideal of $\O_L$, and define $p \coloneqq \mathcal{P}\cap \O_K$, a prime ideal of $\O_K$.

    Let $x \in \mathcal{P}$, then $x$ satisfies an equation of the form
    \[x^n + a_{n-1}x^{n-1} + \ldots + a_0 = 0, a_i \in \O_K\]

    But then $a_0 \in \mathcal{O}\cap \O_K$ is a non-zero element of $p$, and so $p$ is non-zero, and hence maximal.

    We have $\O_K/p \injection \O_L/\mathcal{P}$, and $\O_L/\mathcal{P}$ is a finite dimensional vector space over $\O_K/p$. Since $\O_L/\mathcal{P}$ is an integral domain, it is a field.
  \end{enumerate}
\end{proof}
Note that \textbf{11.5} in fact holds without the assumption that $L/K$ is separable.

\begin{corollary}
  The ring of integers inside a number field is a Dedekind domain.
\end{corollary}
Convention: if $\O_K$ is the ring of integers of a number field, $\f{p} \subseteq \O_K$ a non-zero prime ideal, then we normalise $\abs{\cdot}_\f{p}$ so that
\[\abs{x}_\f{p} = N_\f{p}^{-v_\f{p}(x)}, \text{ where } N_\f{p} = \#\O_K/\f{p}\]

\section{Dedekind Domains \& Extensions}
Let $\O_K$ be a Dedekind domain.
\begin{lemma}
  Let $0 \neq x \in \O_K$. Then:
  \[(x) = \prod_{\f{p}\neq 0}\f{p}^{v_\f{p}(x)}\]
  Note that this product is finite.
\end{lemma}
\begin{proof}
  $x \O_{K, (\f{p})} = (\f{p}\O_{K, (\f{p})})^{v_\f{p}(x)}$ by definition of $v_\f{p}(x)$.

  The lemma then follows from properties of localisation:

  $I = S \iff I \O_{K, (\f{p})} = J \O_{K, (\f{p})}$ for all prime ideals $\f{p}$.
\end{proof}
Notation: for $\O_K$ a Dedekind domain, $L/K$ a finite separable extension, $\mathcal{P} \subseteq \O_L$, $\p \subseteq \O_K$ nonzero prime ideals, we write $\mathcal{P} | \p$ if when we write
\[\p\O_L = \mathcal{P}_1^{e_1}\ldots \mathcal{P}_r^{e_r}, \;\;\;\; e_i >0\]
$\mathcal{P}$ is one of the $\mathcal{P}_i$.

\begin{theorem}
  Let $\O_K$ be a Dedekind domain and $L$ a finite separable extension of $K = \Frac(\O_K)$.

  For $\p$ a nonzero prime ideal of $\O_K$, we write $\p\O_L = \mathcal{P}_1^{e_1} \ldots \mathcal{P}_r^{e_r}$, where $e_i >0$. Then the absolute values on $L$ extending $\abs{\cdot}_\p$ up to equivalence are precisely $\abs{\cdot}_{\mathcal{P}_1}, \ldots, \abs{\cdot}_{\mathcal{P}_r}$.
\end{theorem}
\begin{proof}
  By \textbf{12.1}, for any $x \in \O_K$ and $i = 1, \ldots, r$, we have $v_{\mathcal{P}_i}(x) = e_i v_\p(x)$.

  Hence, up to equivalence, $\abs{\cdot}_{\mathcal{P}_i}$ extend to $\abs{\cdot}_\p$.

  Now suppose that $\abs{\cdot}$ is an absolute value on $L$ extending $\abs{\cdot}_\p$. Then $\abs{\cdot}$ is bounded on $\Z$, and hence by $\abs{\cdot}$ is non-archimedean.

  Now let $R = \{x \in L: \abs{x} \leq 1\} \subseteq L$ be the valuation ring for $L$ with respect to $\abs{\cdot}$. Then $\O_K \subseteq R$, and since $R$ is integrally closed in $L$ (see section 6), we have $\O_L \subseteq R$.

  Set $\mathcal{P}\coloneqq \{x \in \O_L: \abs{x} < 1\}$. It is easy to check that $\mathcal{P}$ is a non-zero prime ideal.

  E.g.: given $x, y \in \mathcal{P}$, then $x+y \in \mathcal{P}$. So if $r \in \O_L, x \in \mathcal{P}$, then $rx \in \mathcal{P}$, and that if $x, y \in \O_L, xy \in \mathcal{P}$ then $x \in \mathcal{P}$ or $y \in \mathcal{P}$, just using properties of non-archimedean absolute values.

  Then $\O_{L, (\mathcal{P})} \subseteq R$, since $s \in \O_L\setminus \mathcal{P}$ gives $\abs{s} = 1$. But $\O_{L, (\mathcal{P})}$ is a DVR and hence a maximal subring of $L$, and so $R = \O_{L, (\mathcal{P})}$. But then $\abs{\cdot}$ is equivalent to $\abs{\cdot}_{\mathcal{P}}$.

  Since $\abs{\cdot}$ extends $\abs{\cdot}_{\p}$, we have $\mathcal{P}\cap \O_K = \p$, and so $\mathcal{P} = \mathcal{P}_i$ for some $i$.
\end{proof}
Let $K$ be a number field. If $\sigma: K \to \R, \C$ is a real or complex embedding, then $x \mapsto \abs{\sigma(x)}_\infty$ defines an absolute value on $K$ - see example sheet 2. This absolute value is denoted $\abs{\cdot}_\sigma$.
\begin{corollary}
  Let $K$ be a number field, with ring of integers $\O_K$, then any absolute value on $K$ is either:
  \begin{enumerate}
    \item $\abs{\cdot}_\p$ for some non-zero prime ideal $\p$.
    \item $\abs{\cdot}_\sigma$ for some $\sigma : K \to \R, \C$.
  \end{enumerate}
\end{corollary}
\begin{proof}
  If $\abs{\cdot}$ is non-archimedean. Then $\abs{\cdot}_\Q$ is non-archimedean, so is equivalent to $\abs{\cdot}_p$ for some prime $p$ by Ostrowski. Then \textbf{12.2} implies that $\abs{\cdot}$ is $\abs{\cdot}_\p$ for some $\p$ a prime of $\O_K$ dividing $(p)$.

  The archimedean case is left as an exercise to example sheet 2.
\end{proof}
\subsection{Completions}
Now let $L/K$ be an extension of number fields with rings of integers $\O_K, \O_L$ respectively. Let $\p \subseteq \O_K$ and $\mathcal{P} \subseteq \O_L$ be non-zero prime ideals such that $\mathcal{P}$ divides $\p$. We write $K_\p$ and $L_\mathcal{P}$ for the completions of $K$ and $L$ with respect to $\abs{\cdot}_\p$ and $\abs{\cdot}_{\mathcal{P}}$ respectively.

\begin{lemma}\hspace*{0cm}
  \begin{enumerate}
    \item The natural map $L \otimes_K K_\p \to L_{\mathcal{P}}$ is surjective.
    \item $[L_{\mathcal{P}}:K_\p] \leq [L:K]$
  \end{enumerate}
\end{lemma}
\begin{proof}
  Let $M = LK_\p \subseteq L_\mathcal{P}$. Then $M$ is a finite extension of $K_\p$ and $[M:K\p] \leq [L:K]$, and moreover $M$ is complete and, since $L \subseteq M \subseteq L_\mathcal{P}$, we have $L_\mathcal{P} = M$.
\end{proof}
\begin{lemma}[Chinese Remainder Theorem]
  Let $R$ be a ring, $I_1, \ldots, I_n \subseteq R$ be ideals such that $I_i + I_j = R$ for all $i \neq j$ (we say the $I_i$ are pairwise coprime). Then:
  \begin{enumerate}
    \item $\bigcap_{i=1}^n I_i = \prod_{i=1}^n I_i = I$
    \item $R/I \cong \prod_{i=1}^n R/I_i$
  \end{enumerate}
\end{lemma}
\begin{proof}
  Example sheet 2.
\end{proof}
\begin{theorem}
  $L \otimes_K K_\p \cong \prod_{\mathcal{P}|\p} L_\mathcal{P}$
\end{theorem}
\begin{proof}
  Write $L = K(\alpha)$ by separability, and let $f(x) \in K[x]$ be the minimal polynomial of $\alpha$.

  Let $f(x) = f_1(x)\ldots f_r(x)$ in $K_\p[x]$ where $f_i(x) \in K_p[x]$ are distinct irreducibles.

  Then $L \cong K[x]/f(x)$, and so by the Chinese remainder theorem:
  \begin{align*}
    L \otimes_K K_\p &\cong K_\p[x]/f(x)\\
    &= \prod_{i=1}^r K_\p[x]/f_i(x)
  \end{align*}
  Set $L_i \coloneqq K_p[x]/f_i(x)$. Since $f_i$ are irreducible, this is field, and hence a finite extension of $K_\p$.

  Then $L_i$ contains both $L$ and $K_\p$, since $K[x]/f(x) \to K_\p[x]/f_i(X)$ is injective, being a non-zero map of fields. Moreover, $L$ is dense in $L_i$, since $K$ is dense in $K_\p$, we can approximate coefficients of an element of $K_\p[x]/f_i(x)$ with an element of $K[x]/f(x)$.

  Then the theorem follows from the following three claims:
  \begin{enumerate}
    \item $L_i \cong L_\mathcal{P}$ for some prime $\mathcal{P}$ of $\O_L$ dividing $\p$.
    \item Each $\mathcal{P}$ appears at most once.
    \item Each $\mathcal{P}$ appears at least once.
  \end{enumerate}
  Proof:
  \begin{enumerate}
    \item Since $[L_i : K_\p] < \infty$, there is a unique absolute value $\abs{\cdot}$ on $L_i$ extending $\abs{\cdot}_\p$. By \textbf{12.2}, restricting this to $L$, it is equivalent to $\abs{\cdot}_\mathcal{P}$ for some $\mathcal{P}|\p$. Since $L$ is dense in $L_i$ and $L_i$ is complete, we have $L_i \cong L_{\mathcal{P}}$.

    \item Suppose $\varphi: L_i \to L_j$ is an isomorphism, preserving $L$ and $K_\p$, then $\varphi$ is given by:
    \begin{align*}
      \varphi: K_\p[x]/f_i(x) &\to K_\p[x]/f_j(x)\\
      x &\mapsto x
    \end{align*}
    But then $f_i(x) = f_j(x)$ and so $i = j$.

    \item By \textbf{12.4}, the natural map $\pi_\mathcal{P}: L \otimes_K K_\p \to L_\mathcal{P}$ is surjective for any $\mathcal{P}|\p$.

    Since $L_{\mathcal{P}}$ is a field, $\pi_\mathcal{P}$ factors through $L_i$ for some $i$, and hence $L_i \cong L_{\mathcal{P}}$ by surjectivity of $\pi_{\mathcal{P}}$.
  \end{enumerate}
\end{proof}
For example, if $K = \Q, L= \Q(\im), f(x) = x^2+1$. Then Hensel tells us $\sqrt{-1} \in \Q_5$, so in $\Q_5$ $f(x)$ factorises. Hence $(5)$ splits in $\Q(i)$, i.e. $5 \O_L = \p_1\p_2$.
\begin{corollary}
  For $x \in L$, we have
  \[N_{L/K}(x) = \prod_{\mathcal{P}|\p} N_{L_{\mathcal{P}}/K_\p}(x)\]
\end{corollary}
\begin{proof}
  Let $\p\O_L = \mathcal{P}_1^{e_1} \ldots \mathcal{P}_r^{e_r}$. Let $\mathcal{B}_1, \ldots, \mathcal{B}_r$ be bases for the completions $L_{\mathcal{P}_1}, \ldots, L_{\mathcal{P}_r}$ as $K_\p$-vector spaces.

  Then $\mathcal{B} = \bigcup_{i=1}^r \mathcal{B}_i$ is a basis for $L \otimes_K K_\p$.

  Let $[\text{mult}(x)]_\mathcal{B}$ (respectively $[\text{mult}]_{\mathcal{B}_i}$) denote the matrix for the map $\text{mult}(x):L\otimes_K K_\p \to L\otimes_K K_\mathcal{P}$ (respectively $\text{mult}(x):L_{\mathcal{P}_i} \to L_{\mathcal{P}_i})$ with respect to the basis $\mathcal{B}$ (respectively $\mathcal{B}_i$). Then
  \[[\text{mult}(x)]_\mathcal{B} = \text{Diag}([\text{mult}(x)]_{\mathcal{B_1}}, \ldots, [\text{mult}(x)]_{\mathcal{B}_r})\]
  And hence
  \[N_{L/K}(x) = \Det([\text{mult}(x)]_\mathcal{B}) = \prod_{i=1}^r \Det([\text{mult}(x)]_{\mathcal{B}_i}) = \prod_{i=1}^r N_{L_{\mathcal{P}_i}/K_\p}(x)\]
\end{proof}
\section{Decomposition Groups}
Let $\O_K$ a Dedekind domain, and $L$ a finite separable extension of $K = \Frac(\O_K)$, and $\O_L$ the integral closure of $\O_K$ in $L$.

We've seen that if $0 \neq \p \subseteq \O_K$ is a prime ideal then we may write
\[\p\O_L = \mathcal{P}_1^{e_1}\ldots \mathcal{P}_r^{e_r}\]
where the $\mathcal{P}_i$ are distinct prime ideals of $\O_L$. Note that, for any $i$, $\p \subseteq \O_K \cap \mathcal{P}_i \subsetneq \O_K$, and hence $\p = \O_K \cap \mathcal{P}_i$.

\begin{definition}\hspace*{0cm}
  \begin{enumerate}
    \item $e_i$ is the \emph{ramification index} of $\mathcal{P}_i$ over $\p$
    \item $\p$ \emph{ramifies} in $L$ if some $e_i > 1$.
  \end{enumerate}
\end{definition}
For example, if $\O_K = \C[t], \O_L = \C[T]$, with $\O_K \injection \O_L; t\mapsto T^n$.

We have $t\O_L = T^n\O_L$, and so the ramification index of $(T)$ over $(t)$ is $n$. This corresponds geometrically to the degree $n$ covering of Riemann surfaces $\C\to \C; x \mapsto x^n$ having a ramification point at 0, with ramification index $n$.

\begin{definition}
  $f_i \coloneqq [\O_L/\mathcal{P}_i : \O_K/\p]$ is the \emph{residue class degree} of $\mathcal{P}_i$ over $\p$.
\end{definition}
\begin{theorem}
  \[\sum_{i=1}^n e_if_i = [L:K]\]
\end{theorem}
\begin{proof}
  Let $S = \O_K \setminus \p$. We have the following facts, whose proofs are left as exercises:
  \begin{itemize}
    \item $S^{-1}\O_L$ is the integral closure of $S^{-1}\O_K$ in $L$.
    \item $S^{-1}\p S^{-1}\O_L \cong S^{-1}\mathcal{P}_1^{e_1}\ldots \mathcal{P}_r^{e_r}$.
    \item $S^{-1}\O_L/S^{-1}\mathcal{P}_i \cong \O_L/\mathcal{P}_i$, and $S^{-1}\O_K/S^{-1}\p \cong \O_K/\p$.
  \end{itemize}
  The second and third conditions imply that $e_i, f_i$ don't change when we localise $\O_K, \O_L$ at $\p$.

  Thus we may assume that $\O_K$ is a DVR, and hence a PID.

  By the Chinese remainder theorem, we have
  \[\O_L/\p\O_L \cong \prod_{i=1}^r \O_L/\mathcal{P}_i^{e_i}\]
  Note that $\O_L/\p\O_L$ is a $k \coloneqq \O_K/\p$-vector space (as $k$ a field), and so we can count dimensions of both sides.

  For each $i$, we have a decreasing sequence of $k$-subspaces:
  \[0 \subseteq \mathcal{P}_i^{e_i-1}/\mathcal{P}_i^{e_i} \subseteq \mathcal{P}_i^{e_i-2}/\mathcal{P}_i^{e_i} \subseteq \ldots \subseteq \mathcal{P}_i/\mathcal{P}_i^{e_i} \subseteq \O_L/\mathcal{P}_i^{e_i}\]
  So $\dim_k \O_L/\mathcal{P}_i^{e_i} = \sum_{j=0}^{e_i-1}\dim_k\left(\mathcal{P}_i^j/\mathcal{P}_i^{j+1}\right)$. Note that this quotient $\mathcal{P}_i^j/\mathcal{P}_i^{j+1}$ is an $\O_L/\mathcal{P}_i$-module and $x \in \mathcal{P}_i^j/\mathcal{P}_i^{j+1}$ (for example, we can prove this after localising at $\mathcal{P}_i$).
  Then $\dim_k \mathcal{P}_i^j/\mathcal{P}_i^{j+1} = f_i$, and we have that
  \[\dim_k \prod_{i=1}^r \O_L/\mathcal{P}_i^{e_i} = \sum_{i=1}^r \dim_k \O_L/\mathcal{P}_i^{e_i} = \sum_{i=1}^r e_if_i\]

  Now recall that $\O_K$ a DVR, and so the structure theorem for modules over PIDs gives $\O_L$ is a free module over $\O_K$ of rank $n = [L:K]$.

  So $\O_L/\p\O_L \cong \left(\O_K/\p\right)^n$ as $\O_K$-modules, and hence $\dim_k \O_L/\p\O_L = n$.
\end{proof}
This theorem is the algebraic analogue of the fact that, for a degree $n$ covering $X \to Y$ of compact Riemann surfaces and $x \in X$, we have
\[n = \sum_{x \in f^{-1}(y)} e_x\]
where $e_x$ is the ramification index of $x$.

Now assume that $L/K$ is Galois. Then, for any $\sigma \in \Gal(L/K)$, $\sigma(\mathcal{P}_i) \cap \O_K = \p$, and hence $\sigma(\mathcal{P}_i) \in \{\mathcal{P}_1, \ldots, \mathcal{P}_r\}$, and so $\Gal(L/K)$ acts on the set $\{\mathcal{P}_1, \ldots, \mathcal{P}_r\}$.

\begin{proposition}
  The action of $\Gal(L/K)$ on $\{\P_1, \ldots, \P_r\}$ is transitive.
\end{proposition}
\begin{proof}
  Suppose the action is not transitive, so that there exists some $i \neq j$ with $\sigma(\mathcal{P}_i)$ is never $\mathcal{P}_j$ for any $\sigma \in \Gal(L/K)$.

  Then the Chinese remainder theorem tells us we may pick $x \in \O_L$ with $x \equiv 0 \mod \mathcal{P}_i$, and $x \equiv 1 \mod \sigma(\mathcal{P}_j)$ for all $\sigma \in \Gal(L/K)$.

  But then $N_{L/K}(x) = \prod_{\sigma \in \Gal(L/K)} \sigma(x) \in \O_K \cap \mathcal{P}_i =\p \subseteq \mathcal{P}_j$.

  Since $\mathcal{P}_j$ is prime, there is some $\tau \in \Gal(L/K)$ with $\tau(x) \in \mathcal{P}_j$, i.e. $x \in\tau^{-1}(\mathcal{P}_j)$, i.e. $x \equiv 0 \mod \tau^{-1}(\mathcal{P}_j) \contr.$
\end{proof}
\begin{corollary}
  Suppose $L/K$ is Galois. Then $e_1 = e_2 = \ldots = e_r \eqqcolon e; f_1 = \ldots = f_r \eqqcolon f$, and $n = efr$.
\end{corollary}
\begin{proof}
  For any $\sigma \in \Gal(L/K)$, we have
  \begin{enumerate}
    \item $\p = \sigma(p) = \sigma(\mathcal{P}_1)^{e_1}\ldots \sigma(\mathcal{P}_r)^{e_r}$. By unique factorisation and transitivity, $e_1 = \ldots = e_r$.
    \item $\O_L/\mathcal{P}_i \cong \O_L/\sigma(\mathcal{P}_i)$, and so $f_1 = \ldots = f_r$.
  \end{enumerate}
\end{proof}
Let $L/K$ be complete discretely valued fields with normalised valuations $v_L, v_K$, uniformisers $\pi_L, \pi_K$. Then the only prime ideals are $\pi_L, \pi_K$.

The ramification index is $e \coloneqq e_{L/K} = v_L(\pi_K)$, i.e. $\pi_L^e \O_L = \pi_K \O_L$.

The residue class degree is $f \coloneqq f_{L/K} = [k_L:k]$.

\begin{corollary}
  Suppose either
  \begin{enumerate}
    \item $L/K$ is finite and separable
    \item $f$ is finite
  \end{enumerate}
  Then $[L:K] = ef$.
\end{corollary}
\begin{proof}\hspace*{0cm}
  \begin{enumerate}
    \item \textbf{13.3}
    \item Can apply the same proof as in \textbf{13.3} if we know $\O_L$ is finitely generated as an $\O_K$-module.

    As before, $\dim_k \O_L/\pi_K\O_L = ef < \infty$, and so we can pick $x_1, \ldots, x_m \in \O_L$, generating $\O_L/\pi_K \O_L$ over $k$.

    Then for $y \in \O_L$, we can write
    \[y = \sum_{i=0}^\infty \left(\sum_{j=1}^m a_{ij}x_j\right)\pi_K^i = \sum_{j=1}^m \left(\sum_{i=0}^\infty a_{ij}\pi_K^i\right)x_j\]
    where $a_{ij} \in \O_K$. But the infinite sum in the middle of the RHS term is in $\O_K$ by completeness, and so the $x_j$ generate $\O_L$ over $\O_K$, and so we can in fact use the proof as in \textbf{13.3}.
  \end{enumerate}
\end{proof}
\begin{definition}
  Let $L/K$ be a finite Galois extension. Then the \emph{decomposition group} at a prime $\mathcal{P}$ of $\O_L$ is the subgroup of $\Gal(L/K)$ defined by
  \[G_\mathcal{P} = \{\sigma \in \Gal(L/K) : \sigma(\mathcal{P}) = \mathcal{P}\}\]
\end{definition}
\textbf{13.4} shows that, for any $\mathcal{P}, \mathcal{P}'$ dividing $\p$, $G_\mathcal{P}$ and $G_{\mathcal{P}'}$ are conjugate, and moreover $G_\mathcal{P}$ has size $ef$, via the orbit-stabilizer theorem.

Recall we write $L_{\mathcal{P}}$ and $K_\p$ for the completions of $L$ and $K$ with respect to $\abs{\cdot}_\mathcal{P}, \abs{\cdot}_\p$ respectively.

\begin{proposition}
  Suppose that $L/K$ is finite and Galois, and $\mathcal{P}$ is a prime ideal of $L$ dividing $\p$.

  Then:
  \begin{enumerate}
    \item $L_\mathcal{P} / K_\p$ is also Galois.
    \item There is a natural map
    \[ \text{res}:\Gal(L_{\mathcal{P}}/L_\p) \to \Gal(L/K)\]
    which is injective, and has image $G_\mathcal{P}$. Here, res is short for ``restriction".
  \end{enumerate}
\end{proposition}
\begin{proof}\hspace*{0cm}
  \begin{enumerate}
    \item $L/K$ Galois implies that $L$ is the splitting field of a separable polynomial $f(x) \in K[x]$, and so $L_\mathcal{P}$ is the splitting field of $f$ considered as an element of $K_\p[x]$.

    Hence $L_\mathcal{P}/K_\p$ is Galois.
    \item Let $\sigma \in \Gal(L_{\mathcal{P}}/K_\p)$. Then $\sigma(L) = L$ since $L/K$ is normal, and hence we have a map $\text{res}:\Gal(L_{\mathcal{P}}/K_p) \to \Gal(L/K)$. Since $L$ is dense in $L_\mathcal{P}$, $\text{res}$ is injective.

    By \textbf{10.2}, $|\sigma(x)|_\mathcal{P} = |x|_\mathcal{P}$ for $x \in L_\mathcal{P}$, and so $\sigma(\mathcal{P}) = \mathcal{P}$ for all $\sigma \in \Gal(L_\mathcal{P}/K_\p)$.

    So $\text{res}(\sigma) \in G_\mathcal{P}$.

    To show surjectivity, it suffices to show that $[L_\mathcal{P} : K_\p] = ef=|G_\mathcal{P}|$.

    We have already seen $|G_\mathcal{P}| = ef$, and we can apply \textbf{13.6} to $L_\mathcal{P}/K_\p$, noting that $e, f$ don't change when we take completions.
  \end{enumerate}
\end{proof}
\section{Ramification Theory}
\subsection{Unramified and Totally Ramified Extensions}
Let $K$ be a non-archimedean local field, and $L$ a finite separable extension of $K$. Then $L$ is a local field.

Last time, we saw $[L:K] = e_{L/K}f_{L/K}$.
\begin{lemma}
  Let $M/L/K$ be finite separable extensions of local fields. Then:
  \begin{enumerate}
    \item $e_{M/K} = e_{M/L}e_{L/K}$
    \item $f_{M/K} = f_{M/L}f_{L/K}$
  \end{enumerate}
\end{lemma}
\begin{proof}\hspace*{0cm}
  \begin{enumerate}
    \item[2.] $f_{M/K} = [k_M:k] = [k_m:k_L][k_L:k] = f_{M/L}f_{L/K}$.
    \item[1.] Follows from (2) and the fact that $[L:K] = e_{L/K}f_{L/K}$.
  \end{enumerate}
\end{proof}
\begin{definition}
  The extension $L/K$ is said to be
  \begin{itemize}
    \item \emph{unramified} if $e_{L/K}$, i.e. $f_{L/K} = [L:K]$
    \item \emph{ramified} if $e_{L/K} > 1$, i.e. $f_{L/K} < [L:K]$
    \item \emph{totally ramified} if $e_{L/K} = [L:K]$, i.e. $f_{L/K} = 1$
  \end{itemize}
\end{definition}
\begin{theorem}
  Let $L/K$ be a finite separable extension of local fields. Then there exists a field $K_0$ such that $K \subseteq K_0 \subseteq L$, with:
  \begin{enumerate}
    \item $K_0/K$ unramified
    \item $L/K_0$ totally ramified
  \end{enumerate}
  Moreover, $[K_0:K] = f_{L/K}, [L:K_0] = e_{L/K}$, and $K_0/K$ is Galois.
\end{theorem}
\begin{proof}
  Let $k = \F_q$, so that $k_L = \F_{q^f}$ where $f = f_{L/K}$. Set $m = q^f-1$. Then let $[\cdot]:\F_{q^f}^\times \to L^\times$ be the Teichm\"uller map for $L$, and let $\zeta_m = [a]$, where $a$ generates $\F_{q^f}^\times$. Then $\zeta_m$ is a primitive $m\th$ root of unity.

  We set $K_0 = K(\zeta_m) \subseteq L$. Then $K_0$ is the splitting field of the separable polynomial $f(x) = x^m-1 \in K[x]$, and hence $K_0/K$ is Galois.

  Since $|\zeta_m| = 1$, $\zeta_m \in \O_{K_0}^\times$. It follows that $k_0 \coloneqq \O_{K_0}/\mathfrak{m}_0$ contains a primitive $n\th$ root of unity, so $k_0 = \F_{q^f} \cong k_L$.

  Now $\Gal(K_0/K)$ preserves $\O_{K_0}$ and $\mathfrak{m}_0$, using $|x| = |\sigma(x)|$. So there is a natural map
  \[\text{res}:\Gal(K_0/K) \to \Gal(k_0/k)\]
  For $\sigma \in \Gal(K_0/K)$, we have
  \[\sigma(\zeta_m) = \zeta_m\text{ if } \sigma(\zeta_m) \equiv \zeta_m \mod \mathfrak{m}_0\]
  since $\sigma(\zeta_m) = [\text{res}(\sigma)(\zeta_m \mod \mathfrak{m}_0)]$, and so $\text{res}$ is injective, and so
  \[|\Gal(K_0/K)| \leq |\Gal(k_0/k)| = f = f_{L/K}\]
  and so $[K_0:K] = f_{L/K}$ and $\text{res}$ is an isomorphism, and $K_0$ is unramified.

  Since $k_0 \cong k_L, f_{L/K_0} = 1$, hence $L/K_0$ is totally ramified.
\end{proof}
\begin{theorem}
  Let $K$ be a non-archimedean local field with $k \cong \F_q$. For any $n \geq 1$, there is a unique unramified extension $L/K$ of degree $n$. Moreover, $L/K$ is Galois, and the natural map $\Gal(L/K) \to \Gal(k_{L}/k)$ is an isomorphism. In particular, $\Gal(L/K)$ is a cyclic group, generated by an element $\Frob_{L/K}$ such that
  \[\Frob_{L/K}(x) \equiv x^q \mod \f{m}_L \forall x \in \O_L\]
\end{theorem}
\begin{proof}
  For $n \geq 1$, we take $L = K(\xi_m)$, where $m = q^n-1$ and $\zeta_m \in \bar{K}^\times$ is a primitive $m\th$ root of unity. Then, as in the proof of \textbf{14.3}, $\Gal(L/K) \cong \Gal(k_L/k) \cong \Gal(\F_{q^n}/\F_q)$, and is cyclic and generated by a lift of $x \mapsto x^q$.

  Uniqueness is clear since, for $L/K$ of degree $n$ unramified, we have $\zeta_m \in L$, and hence $L = K(\zeta_m)$ by degree reasons.
\end{proof}
\begin{corollary}
  If $K$ is a non-archimedean local field and $L/K$ finite and Galois, then the natural map
  \[\text{res}:\Gal(L/K) \to \Gal(k_L/k)\]
  is surjective.
\end{corollary}
\begin{proof}
  With the notation of \textbf{14.3}, the map $\text{res}$ factors as
  \[\Gal(L/K) \to \Gal(K_0/K) \to \Gal(k_L/k)\]
  The inertia subgroup $I_{L/K} \subseteq \Gal(L/K)$ is defined to be the kernel of the surjective map
  \[ \text{res}:\Gal(L/K) \surjection \Gal(k_L/k)\]
  Since $e_{L/K} f_{L/K} = [L:K]$, we have $|I_{L/K}| = e_{L/K}$.

  There is an exact sequence
  \begin{center}
    \begin{tikzcd}
      0 \arrow{r} & I_{L/K} \arrow{r}{i} & \Gal(L/K) \arrow{r}{p} & \Gal(k_L/k) \arrow{r} & 0
    \end{tikzcd}
  \end{center}
  Now $I_{L/K} = \Gal(L/K_0)$, and so $L_{K_0}$ is a totally ramified extension.
\end{proof}
\begin{definition}
  Let $K$ be a local non-archimedean local field, with normalised valuation $v$. Let
  \[f(x) = x^n + a_{n-1}x^{n-1}+\ldots+a_0 \in \O_K[x]\]
  We say $f(x)$ is \emph{Eisenstein} if $v(a_i) \geq 1$ for all $i$ and $v(a_0) = 1$.
\end{definition}
Fact: Eisenstein polynomials are irreducible.
\begin{theorem}\hspace*{0cm}
  \begin{enumerate}
    \item If $L/K$ is a finite totally ramified extension of non-archimedean local fields, then the minimal polynomial of $\pi_L \in \O_L$ is an Eisenstein polynomial, and $\O_L = \O_K[\pi_L]$, and hence $L = K(\pi_L)$.
    \item Conversely, if $f(x) \in \O_K[x]$ is Eisenstein and $\alpha$ is a root of $f$. Then $L \coloneqq K(\alpha)/K$ is totally ramified.
  \end{enumerate}
\end{theorem}
\begin{proof}\hspace*{0cm}
  \begin{enumerate}
    \item Let $v_L$ be the normalised valuation for $L$, and set $e \coloneqq [L:K]$. Let $f(x) = x^m+a_{m-1}x^{m-1}+\ldots + a_0 \in \O_K[x]$ be the minimal polynomial for $\pi_L$, which is monic since $\O_L$ is integral over $\O_K$.

    Then $m \leq e$.

    Since $v_L(K^\times) = e\Z$, we have
    \[v_L(a_i\pi_L^i) \equiv i \mod e \forall i <m\]
    so that these terms all have different residues mod $e$. We have
    \[\pi_L^m = -\sum_{i=0}^{m-1}a_i \pi_L^i\]
    and hence $m = v_L(\pi_L^m) = \min\limits_{0\leq i \leq m-1}(i+ev_k(a_i))$, so $v_K(a_i) \geq 1 \forall i$, and so $m=e$ and $v_K(a_0) = 1$, hence $f(x)$ is Eisenstein, and $L = K(\pi_L)$.

    For $y \in L$, we write $y = \sum_{i=0}^{e-1} \pi_L^i b_i, b_i \in K$.

    Then $v_L(y) = \min\limits_{0 \leq i \leq m-1} (i+ev_K(b_i))$, and so $y \in \O_L \iff v_L(y) \geq 0 \iff v_K(b_i) \geq 0 \forall i$, i.e. $y \in \O_K[\pi_L]$.

    \item Let $f(X) = x^n+a_{n-1} + \ldots + a_0$ be Eisenstein, and let $e \coloneqq e_{L/K}$. Then $v_L(a_i) \geq e$, and $v_L(a_0) = e$.

    If $v_L(\alpha) \leq 0$ we have $v_L(\alpha^n) < v_L(\sum_{i=0}^{n-1} a_i \alpha^i)\contr$, and so $v_L(\alpha) > 0$.

    For $i \neq 0, v_L(a_i \alpha^i) > e = v_L(a_0)$, and it follows that
    \[v_L(-\sum_{i=0}^{n-1}a_i \alpha^i) = e\]
    and hence $v_L(\alpha^n) = e \implies nv_L(\alpha) = e$.

    But $n = [L:K] \geq e \implies n = e$, and $L$ is totally ramified.
  \end{enumerate}
\end{proof}
\section{Structure of Units}
Let $[K:\Q_p]<\infty$, with normalised valuation $v_K$ and uniformiser $\pi$, and write $e \coloneqq e_{K/\Q_p}$, the absolute ramification index.

\begin{proposition}
  If $r > \frac{e}{p-1}$, then the series
  \[\exp(x) = \sum_{n=0}^\infty \frac{x^n}{n!}\]
  converges on $\pi^r\O_K$, and $\exp$ determines an isomorphism between
  \[(\pi^r\O_K, +) \isomarrow (1+\pi^r\O_K, \times)\]
\end{proposition}
\begin{proof}
  $v_K(n!) = ev_p(n!) = e\frac{n-s_p(n)}{p-1} \leq e\frac{n-1}{p-1}$ - see example sheet 1.

  For $x \in \pi^r\O_K$, we have for $n \geq 1$:
  \[v_K(x^n/n!) \geq nr - e \frac{n-1}{p-1} = r+(n-1)\left(r-\frac{e}{p-1}\right)\]

  Hence $v_K(x^n/n!) \to \infty$ as $n \to \infty$, and hence $\exp(x)$ converges.

  Since $v_K\left(\frac{x^n}{n!}\right) \geq r$ for $n\geq 1$, $\exp(x) \in 1+\pi^r \O_K$.

  Similarly, consider $\log:1+\pi^r \O_K \to \pi^r\O_K$ given by
  \[\log(1+x) = \sum_{n=1}^\infty \frac{(-1)^{n-1}}{n}x^n\]
  We can check convergence as before.

  Recall properties of power series:
  \begin{itemize}
    \item $\exp(x+y) = \exp(x)\exp(y)$
    \item $\log(xy) = \log(x)+\log(y)$
    \item $\exp(\log(x)) = x = \log(\exp(x))$
  \end{itemize}
  Thus $\exp:(\pi^r \O_K, +) \to (1+\pi^r\O_K, \times)$ is an isomorphism of groups.
\end{proof}
Now let $K$ be a non-archimedean local field. We define a filtration on $\O_K^\times$. Write $U_K = \O_K^\times$, the unit group of $\O_K$.
\begin{definition}
  For $s \in \Z_{\geq 1}$, the $s\th$ unit group $U_K^{(s)}$ is defined to be
  \[U_K^{(s)} = (1+\pi^s\O_K, \times)\]
  We set $U_K^{(0)} = U_K$. Then we have
  \[\ldots \subseteq U_K^{(s)} \subseteq U_K^{(s-1)} \subseteq \ldots \subseteq U_K^{(0)} = U_K\]
\end{definition}
\begin{proposition}
  We have:
  \begin{enumerate}
    \item $U_K^{(0)}/U_K^{(1)} \cong (k^\times, \times)$
    \item $U_K^{(s)}/U_K^{(s+1)} \cong (k, +)$
  \end{enumerate}
\end{proposition}
\begin{proof}\hspace*{0cm}
  \begin{enumerate}
    \item Reduction mod $\pi$ gives a natural; surjection $\O_K^\times \to k^\times$. The kernel is then $1+\pi\O_K = U_K^{(1)}$.

    \item Define $f:U_K^{(s)} \to k$ given by $1+\pi^s x \mapsto x \mod \pi$.

    Then $(1+\pi^sx)(1+\pi^sy) = 1+\pi^s(x+y+\pi^sxy)$. Since $x+y+\pi^sxy \equiv x+y \mod \pi$, $f$ is a group homomorphism. It is easy to see that $f$ is surjective, and that $\ker f = U_K^{(s+1)}$.
  \end{enumerate}
\end{proof}
\begin{corollary}
  Let $[K:\Q_p]<\infty$. Then $\O_K^\times$ has a subgroup of finite index isomorphic to $(\O_K, +)$.
\end{corollary}
\begin{proof}
  Let $r >\frac{e}{p-1}$. Then $(\O_K, +) \cong U_K^{(r)}$. So $U_K^{(r)}\subseteq U_K$ is of finite index by \textbf{15.3}.
\end{proof}
For example, in the case of $\Z_p$, if $p>2, e=1$, we can take $r = 1$. Then:
\begin{align*}
  \Z_p^\times &\isomarrow (\Z/p\Z)^\times \times (1+p\Z_p) \cong \Z/(p-1)\Z \times \Z_p\\
  x&\mapsto \left(x \mod p, \frac{x}{[x \mod p]}\right)
\end{align*}
If $p=2$, then we need $r=2$. Then we get:
\[\Z_2^\times \isomarrow (\Z/4\Z)^\times \times(1+4\Z_2)\cong \Z/2\Z \times \Z_2\]
This gives us another proof of the fact that
\[\Z_p^\times/(\Z_p^\times)^2 \cong \begin{cases}\Z/2\Z & p >2 \\ (\Z/2\Z)^2 & p=2\end{cases}\]
\section{Higher Ramification Groups}
Let $L/K$ be a finite Galois extension of non-archimedean local fields. We define an analogous filtration of $\Gal(L/K)$:
\begin{definition}
  Let $v_L$ be the normalised valuation on $L$. For $s \in \R_{\geq -1}$, we define the $s\th$ ramification group
  \[G_s(L/K) = \{\sigma \in \Gal(L/K) : v_L(\sigma(x)-x)\geq s+1 \forall x \in \O_L\}\]
\end{definition}
$G_{-1}(L/K) = \Gal(L/K)$.

\mbox{$G_0(L/K) = \{\sigma\in\Gal(L/K):\sigma(x)\equiv x \mod \pi_L \forall x \in \O_L\} = \ker(\Gal(L/K)\surjection \Gal(k_L/k)) = I_{L/K}$}

In general, for $s \in \Z_{\geq 0}$, $G_s(L/K)$ is the kernel of the map $\Gal(L/K) \to \Aut(\O_L/\pi_L^{s+1}\O_L))$, and hence $G_s(L/K)$ is normal in $G$.

We have a filtration for $s \in \Z_{\geq 1}$:
\[\ldots \subseteq G_s \subseteq G_{s-1}\subseteq \ldots \subseteq G_{-1} = \Gal(L/K)\]
We have defined $G_s$ for $s$ real, but in fact $G_s$ only changes at the integers. We'll use this definition in terms of real numbers later though.

\begin{theorem}\hspace*{0cm}
  \begin{enumerate}
    \item Let $\pi_L \in \O_L$ be a uniformizer.
    For $s \geq 1, G_s = \{\sigma \in G_0:v_L(\sigma(\pi_L)-\pi_L)\geq s+1\}$.
    \item $\bigcap_{n=0}^\infty G_n = \{1\}$.
    \item Let $s \in \Z_{\geq 0}$. There is an injective group homomorphism
    \[G_s/G_{s+1} \injection U_L^{(s)}/U_L^{(s+1)}\]
    induced by the map $\sigma\mapsto \sigma(\pi_L)/\pi_L$. This map is independent of the choice of $\pi_L$.
  \end{enumerate}
\end{theorem}
\begin{proof}
  Let $K_0 \subseteq L$ be the maximal unramified extension of $K$ contained in $L$. Upon replacing $K$ by $K_0$, we may assume $L/K$ is totally ramified.
  \begin{enumerate}
    \item By \textbf{14.8}, $\O_L = \O_K[\pi_L]$. Suppose $v_L(\sigma(\pi_L)-\pi_L) \geq s+1$. Now let $x \in \O_L$, then $x = f(\pi_L)$ for $t \in \O_K[t]$.

    Then $\sigma(x)-x = \sigma(f(\pi_L))-f(\pi_L) = f(\sigma(\pi_L)) - f(\pi_L) = (\sigma(\pi_L) - \pi_L)g(\pi_L)$ where $g \in \O_K[t]$, as $\sigma(\pi_L) = \pi_L$ is a root.

    So $v_L(\sigma(x)-x) = v_L(\sigma(\pi_L)-\pi_L) + v_L(g(\pi_L)) \geq s+1$.

    \item Suppose that $\sigma \in \Gal(L/K)$, $\sigma \neq 1$. Then $\sigma(\pi_L)\neq \pi_L$ because $L = K(\pi_L)$, and hence $v_L(\sigma(\pi_L)-\pi_L) < \infty$. Thus $\sigma \notin G_s$ for $s \gg 0$.

    \item Note that, for $\sigma \in G_s, s \geq 0$, we have $\sigma(\pi_L) \in \pi_L + \pi_L^{s+1}\O_L$. So then
    \[\sigma(\pi_L)/\pi_L \in 1+ \pi_L^s \O_L\]
    We claim that $\varphi:G_s \to U_L^{(s)}/U_L^{(s+1)}$, $\sigma \mapsto \sigma(\pi_L)/\pi_L$ is a group homomorphism with kernel $G_{s+1}$.

    For the homomorphism part, take $\sigma, \tau \in G_s$, and let $\tau(\pi_L) = u\pi_L, u \in \O_L^\times$. Then:
    \begin{align*}
      \frac{\sigma\tau(\pi_L)}{\pi_L} &= \frac{\sigma(\tau(\pi_L))}{\tau(\pi_L)}\cdot \frac{\tau(\pi_L)}{\pi_L}\\
      &= \frac{\sigma(u)}{u}\cdot\frac{\sigma(\pi_L)}{\pi_L}\cdot\frac{\tau(\pi_L)}{\pi_L}
    \end{align*}
    But $\sigma(u)\in u+\pi_L^{s+1}\O_L$ since $\sigma \in G_s$, and thus $\frac{\sigma(u)}{u} \in U_L^{(s+1)}$, and hence
    \[\frac{\sigma\tau(\pi_L)}{\pi_L} \equiv \frac{\sigma(\pi_L)}{\pi_L}\cdot \frac{\tau(\pi_L)}{\pi_L}\mod U_L^{(s+1)}\]
    so $\varphi$ is a group homomorphism.

    Moreover, $\ker \varphi = \{\sigma\in G_s : \sigma(\pi_L)\equiv \pi_L \mod \pi_L^{s+2}\} = G_{s+1}$.

    If $\pi_L' = a\pi_L$ is another uniformizer, and $a \in U_L$, then $\sigma(\pi_L')/\pi_L' = \frac{\sigma(a)}{a}\frac{\sigma(\pi_L)}{\pi_L}\equiv \frac{\sigma(\pi_L)}{\pi_L} \mod U_L^{(s+1)}$.
  \end{enumerate}
\end{proof}
\begin{corollary}
  $\Gal(L/K)$ is solvable.
\end{corollary}
\begin{proof}
  By \textbf{15.2}, \textbf{16.2}, and \textbf{14.4}, for $s \in \Z_{\geq -1}$, $G_s/G_{s+1}\cong \text{ a subgroup of one of }\begin{cases} \Gal(k_L/k) & s = -1 \\ (k_L^\times, \times) & s = 0\\ (k_l, +) & s \geq 1\end{cases}$.

  These are all cyclic groups, and hence $G_s/G_{s+1}$ is cyclic for $s \geq -1$.

  We thus conclude via \textbf{16.2.2} that $\Gal(L/K)$ is solvable.
\end{proof}
Let $\charr K = p$. Then $|G_0/G_1|$ is coprime to $p$ and $|G_1| = p^n$ for some $n \geq 0$. Thus $G_1$ is the unique (since it is normal) Sylow-$p$ subgroup of $G_0 = I_{L/K}$.
\begin{definition}
  The group $G$ is called the \emph{wild inertia group} and $G_0/G_1$ is the \emph{tame quotient}.

  We say $L/K$ (not necessarily Galois) is \emph{tamely ramified} if $\charr k = p \nmid e_{L/K}$, which, in the case when $L/K$ is Galois, is equivalent to $G_1 = \{1\}$. Otherwise it is \emph{wildly ramified}.
\end{definition}
We can thus break up $L/K$ into $L/K'/K_0/K$, where $L/K'$ is totally wildly ramified, $K'/K_0$ is totally tamely ramified, and $K_0/K$ is unramified.

\textbf{Example.} $K = \Q_p$. Let $\zeta_{p^n}$ be a primitive $p^n\th$ root of unity. Let $L = \Q_p(\zeta_{p^n})$.

Then the $p^n\th$ cyclotomic polynomial
\[\Phi_{p^n}(x) = x^{p^{n-1}(p-1)}+x^{p^{n-1}(p-2)}+\ldots+1\]
is the minimal polynomial of $\zeta_{p^n}$. The following 3 facts are exercises on sheet 3:
\begin{itemize}
  \item $\Phi_{p^n}(x)$ is irreducible.
  \item $L/\Q_p$ is Galois and totally ramified of degree $p^{n-1}(p-1)$.
  \item $\pi \coloneqq \zeta_{p^n}-1$ is a uniformizer of $\O_L$, and hence $\O_L = \Z_p[\zeta_{p^n}-1]$.
\end{itemize}
Now $\Gal(L/\Q_p) \cong (\Z/p^n\Z)^\times$ given by sending $(\sigma_m:\zeta_{p^n}\mapsto \zeta_{p^n}^m)\mapsfrom m$.

Let $k$ be maximal such that $p^k | m-1$. Then $\zeta_{p^n}^{m-1}$ is a primitive $p^{n-k}\th$ root of unity, and so $\zeta_{p^n}^{m-1}-1$ is a uniformizer $\pi'$ in $L'\coloneqq \Q_p(\zeta_{p^n}^{m-1})$.

So $v_L(\sigma(\pi)-\pi) = v_L(\pi') = e_{L/L'} = \frac{e_{L/\Q_p}}{e_{L'/\Q_p}} = \frac{[L:\Q_p]}{[L':\Q_p]} = \frac{p^{n-1}(p-1)}{p^{n-k-1}(p-1)} = p^k$

By \textbf{16.2.1}, $\sigma \in G_i \iff p^k\geq i+1$. Thus:
\[G_i \cong \begin{cases} (\Z/p^n\Z)^\times & i < 0 \\ (1+p^k\Z)/p^n\Z & p^{k-1}-1<i\leq p^{k}-1, 1\leq k\leq n-1\\ \{1\} & i > p^{n-1}-1\end{cases}\]
These are reminiscent of $U_{\Q_p}^{(k)}$.

\subsection{Upper Numbering of Ramification Groups}
These ramification groups behave well with respect to taking subgroups:
\begin{proposition}
  Let $L/F/K$ be finite extensions of non-archimedean local fields, with $L/K$ Galois.

  Then for $s \in \R_{\geq-1}$,
  \[G_s(L/F) = G_s(L/K)\cap \Gal(L/F)\]
\end{proposition}
\begin{proof}
  $G_s(L/F) = \{\sigma \in \Gal(L/F) : v_L(\sigma(x)-x) \geq s+1 \forall x \in \O_L\} = \Gal(L/F) \cap G_s(L/K)$
\end{proof}
However, $G_s$ behave badly with respect to taking quotients. We fix this by renumbering.

Let $L/K$ be finite and Galois. Define a function $\phi \coloneqq \phi_{L/K}:\R_{\geq -1}\to \R$ by
\[\phi(s) = \int_0^s \frac{1}{[G_0:G_t]}dt\]
As a convention, we write, for $t\in [-1, 0]$, $\frac{1}{[G_0:G_t]} = [G_t:G_0]$.

We have for $m \leq s < m+1$,
\[\phi(s) = \begin{cases} s & m = -1\\\frac{1}{|G_0|}(|G_1|+\ldots+|G_m|+(s-m)|G_{m+1}|) & m \geq 0\end{cases}\]
Thus $\phi$ is continuous, piecewise linear, and strictly increasing.

Fix notation: $L/F/K$ are finite extensions of non-archimedean local fields with $L/K$ and $F/K$ Galois. Take $G \coloneqq \Gal(L/K)$ and $H \coloneqq \Gal(L/F)$, and so $G/H = \Gal(F/K)$.

Then for $s \in \R_{\geq-1}$, we will write $G_s, H_s, (G/H)_s$ for the $s\th$ higher ramification groups for $G, H, (G/H)$ respectively.
\begin{theorem}[Herbrand's Theorem]
  Let $L/F/K$ be as above. Then for $s\in \R_{\geq -1}$, we have
  \[\frac{G_sH}{H} = (G/H)_{\phi_{L/F}(s)}\]
\end{theorem}
\begin{proof}
  Next lecture.
\end{proof}
As $\phi_{L/K}$ is continuous and strictly increasing, we may define $\psi_{L/K} \coloneqq \phi_{L/K}^{-1}$.
\begin{definition}[Upper Numbering]
  Let $L/K$ be a finite Galois extension of non-archimedean local fields. The higher ramification groups in upper numbering is defined by
  \[G^s(L/K) \coloneqq G_{\psi_{L/K}(s)}(L/K)\]
\end{definition}
We can thus rephrase \textbf{16.6} as follows:
\begin{lemma}Let $L/F/K$ be as above.
  \begin{enumerate}
    \item $\phi_{L/K}  = \phi_{F/K}\circ \phi_{L/F}$
    \item $\psi_{L/K} = \psi_{L/F} \circ \psi_{F/K}$
  \end{enumerate}
\end{lemma}
\begin{proof}
  Since $\psi = \phi^{-1}$, it suffices to just prove \textit{1.}

  $\phi_{L/K}$ and $\phi_{F/K}\circ \phi_{L/F}$ are piecewise linear and $\phi_{L/K}(0) = \phi_{F/K}\circ \phi_{L/F}(0) = 0$. Then it suffices to show that their derivatives are equal.

  Let $r = \phi_{L/F}(s)$. Then
  \begin{align*}
    (\phi_{F/K}\circ \phi_{L/F})'(s) &= \phi'_{L/F}(s) \phi'_{F/K}(r)\\
    &= \frac{|H_s|}{|H_0|}\frac{|(G/H)|_r}{|G/H|_0}\\
    &= \frac{|H_s|}{e_{L/F}}\frac{|(G/H)_r|}{e_{F/K}}
  \end{align*}
  Now \textbf{16.6} implies that $(G/H)_r = \frac{G_sH}{H} = \frac{G_s}{G_s \cap H} = \frac{G_s}{H_s}$ by \textbf{16.3}.

  So $\phi'_{L/K}(s) = \frac{|G_s|}{|G_0|} = \frac{|H_s||(G/H)_R|}{e_{L/K}}$, and $e_{L/K} = e_{L/F}e_{F/K}$, so we are done.
\end{proof}
\begin{corollary}For $t \in [-1, \infty]$, we have
  \[\frac{G^tH}{H} = (G/H)^t\]
\end{corollary}
\begin{proof}
  Let $r =\psi_{F/K}(t)$. Then
  \[(G/H)^t = (G/H)_r = G_{\psi_{L/K}(r)}H/H = G^tH/H\].
\end{proof}

\section{Proof of Herbrand's Theorem}
Let $L/F/K$ be finite extensions of non-archimedean local fields, with $L/K, F/K$ Galois, with $G = \Gal(L/K), H = \Gal(L/F)$.

Recall Herbrand's theorem:

\textbf{Theorem 16.6} (Herbrand's Theorem).
\[G_sH/H = (G/H)_{\phi_{F/L}(s)}\]
We introduce an auxiliary function:
\begin{definition}
  Let $L/K$ be finite and Galois, with $\sigma \in \Gal(L/F)$. Then we define:
  \begin{align*}
    i_{L/K}: \Gal(L/K) & \to \Z\\
    i_{L/K}(\sigma) &= \min_{x \in \O_L} v_L(\sigma(x)-x)\\
    &= \max\{i \in \Z: \sigma \in G_{i-1}\}
  \end{align*}
  By convention, $i_{L/K}(1) = \infty$.
\end{definition}
Note that $G_s(L/K) = \{\sigma \in \Gal(L/K):i_{L/K}(\sigma) \geq s+1\}$.
\begin{lemma}
  Let $L/K$ be finite and Galois. Let $x \in \O_L$ such that $\O_K[x] = \O_L$. Then:
  \begin{enumerate}
    \item $i_{L/K}(\sigma) = v_L(\sigma(x)-x)$.
    \item $G_s(L/K) = \{\sigma \in \Gal(L/K): v_L(\sigma(x)-x)\geq s+1\}$.
  \end{enumerate}
\end{lemma}
\begin{proof}
  Let $y \in \O_L$, then $y = f(x)$ for some polynomial $f \in \O_K[X]$. The same argument as in \textbf{15.6.1} shows that $\sigma(x)-x | \sigma(y)-y$ in $\O_L$.

  Hence $v_L(\sigma(y)-y) \geq v_L(\sigma(x)-x)$, and we have both parts.
\end{proof}
\begin{proposition}
  Let $L/F/K$ be as above, and let $\sigma \in G$. Then we have
  \[i_{F/K}(\sigma H) = e_{L/F}^{-1}\sum_{\tau \in H}i_{L/K}(\sigma \tau)\]
\end{proposition}
\begin{proof}
  When $\sigma = 1$, we interpret this as ``$\infty = \infty$".

  When $\sigma \neq 1$, let $v_L$ and $v_F$ denote the normalised valuations on $L$ and $F$. Let $x \in \O_F, y \in O_L$, such that $\O_F = \O_K[x]$, and $\O_L = \O_K[y]$.

  Define $a \coloneqq \sigma(x)-x \in \O_L$, and $b \coloneqq \prod_{\tau \in H} (\sigma\tau(y)-y) \in \O_L$.

  Then $e_{L/F}i_{F/K}(\sigma H) = e_{L/F}v_F(\sigma(x)-x) = v_L(\sigma(x)-x) = v_L(a)$.

  And $\sum_{\tau \in H} i_{L/K}(\sigma \tau) = \sum_{\tau \in H}v_L(\sigma\tau(y)-y) = v_L(\prod_{\tau \in H}(\sigma \tau(y)-y)) = v_L(b)$.

  We need to show that $v_L(a) = v_L(b)$. We will show this by showing that $a|b$ and $b|a$ in $\O_L$.

  For $a|b$, let $f \in \O_F[X]$ be the minimal polynomial for $y$ over $\O_F$. Then
  \[f(x) = \prod_{\tau \in H} (X-\tau(y))\]
  and $\sigma(f)(X) = \prod_{\tau \in H} (X -\sigma\tau(y))$.

  Since $\O_F = \O_K[x]$, $a = \sigma(x)-x$ divides $\sigma(z)-z$ for all $z \in \O_F$.

  Thus $a$ divides all coefficients of $\sigma(f)(X) - f(X)$, and so $a|\sigma(f)(y)-f(y) = \sigma(f)(y) = \pm b$.

  For $b|a$, let $g \in \O_K[X]$ be such that $x = g(y)$. Then $g(X)-x \in \O_F[X]$ has $y$ as a root, and so $g(X)-x = f(X)h(X)$ for some $h \in \O_F[X]$.

  Applying $\sigma$ and evaluating at $y$ gives:
  \[\sigma(g)(y) - \sigma(x) = \sigma(f)(y)\sigma(h)(y) = b\sigma(g)(y)\]
  But $\sigma(h)(y) \in O_L$, and $\sigma(g)(y) = g(y) = x$, and $b |a$.
\end{proof}
\begin{lemma}
  Let $L/K$ be a finite Galois extension of non-archimedean local fields, and $\sigma \in G = \Gal(L/K)$. Then
  \[\phi_{L/K}(s) = -1 + \frac{1}{|G_0|}\sum_{\sigma \in G} \min\{i_{L/K}(\sigma), s+1\}\]
  for any $s \in \R_{\geq 1}$.
\end{lemma}
\begin{proof}
  Since both sides are piecewise linear and continuous. Let $\theta(s) = \textsc{RHS}$. Then $\phi_{L/K}(-1) = -1 = \theta(-1)$.

  Thus it suffices to show $\theta' = \phi_{L/K}'$.

  $\theta'(u) = \frac{1}{|G_0|}\cdot \#\{\sigma \in G : i_{L/K}(\sigma) \geq s+1\} = \frac{|G_s|}{|G_0|} = \phi_{L/K}'$ by the fundamental theorem of calculus.
\end{proof}
\begin{proof}[Proof of Herbrand's Theorem]
  Define a function $j:G/H \to \Z\cup \{\infty\}$ by
  \[j(\sigma H) = \max_{\tau \in H}\{i_{L/K}(\sigma \tau)\}\]
  for $\sigma \in G$.

  Then we have $\sigma H \in G_sH/H \iff j(\sigma H)-1 \geq s \iff \phi_{L/F}(j(\sigma H) - 1) \geq \phi_{L/F}(s)$, as $\phi$ is strictly increasing.

  On the other hand, we have $\sigma H \in (G/H)_{\phi_{L/F}(s)} \iff i_{F/K}(\sigma H) - 1 \geq \phi_{L/F}(s)$

  Thus it suffices to show
  \[\phi_{L/F}(j(\sigma H)-1) = i_{F/K}(\sigma H) - 1 \tag{$\ast$}\]
  We can assume $\sigma \notin H$, as then this just say ``$\infty=\infty$". Upon replacing $\sigma$ by another element in $\sigma H$, we may assume
  \[j(\sigma H) = i_{L/K}(\sigma) \eqqcolon m\]
  i.e. $\sigma \in G_{m-1}\setminus G_m$.

  Now if $\tau \in H_{m-1} = G_{m-1}\cap H$, then $\sigma \tau \in G_{m-1} \implies i_{L/K}(\sigma \tau) \geq m$, and so $i_{L/K}(\sigma \tau) = m$, by maximality of $m$.

  On the other hand, if $\tau \notin H_{m-1}$, then $\sigma\tau \notin G_{m-1}$, and so $i_{L/K}(\sigma \tau) < m$, and $i_{L/K}(\sigma \tau) = i_{L/K}(\tau)$.

  In either case, we have, for any $\tau \in H$, we have $i_{L/K}(\sigma \tau) = \min(i_{L/K}(\tau), m)$.

  By \textbf{17.3}, we have
  \[i_{F/K}(\sigma H) = e_{L/F}^{-1}\sum_{\tau \in H}\min(i_{L/K}(\tau), m)\]
  But $i_{L/K}(\tau) = i_{L/F}(\tau)$ and $e_{L/F} = |H_0|$.

  Thus \textbf{17.4} gives us that
  \begin{align*}
    i_{F/K}(\sigma H) &= \frac{1}{|H_0|}\sum_{\tau \in H} \min(i_{L/F}(\tau, m))\\
    &= \phi_{L/F}(m-1)+1\\
    &= \phi_{L/F}(j(\sigma H)-1)+1
  \end{align*}
  and so we have $(\ast)$.
\end{proof}
For example, take $K = \Q_p, L = \Q_p(\zeta_{p^n})$. Then $G \cong (\Z/p^n\Z)^\times$.

Let $k \in \Z, 1 \leq k \leq n-1$. For $p^{k-1}-1 < s \leq p^{k}-1$, we have
\[G_s \cong \{m \in (\Z/p^n\Z)^\times: m \equiv 1 \mod p^k\}\]
Let's compute $\phi_{L/K}$. Since $G_s$ jumps at $p^{k-1}$, we have $\phi_{L/K}$ linear on $[p^{k-1}-1, p^k-1]$.

It suffices to determine $\phi_{L/K}(p^k-1)$.

We claim $\phi_{L/K}(p^k-1) = k$. This follows as $[G_0:G_k] = p^k(p-1)$.

Thus $G^s \cong \begin{cases} (\Z/p^n\Z)^\times & s \leq 0 \\ (1+p^k \Z)/p^n\Z & k-1<s\leq k \\ \{1\} & s>n-1\end{cases}$.
Note that $\phi(p^k-1)$ is an integer - this is a priori not clear.

\begin{definition}
  We say $i$ is a \emph{jump in a the filtration} $(G^s)_{s \in R_{\geq-1}}$ if $G^i \neq G^j$ for all $j > i$.
\end{definition}
\begin{theorem}[Hasse-Arf]
  If $\Gal(L/K)$ is abelian, then the jumps of the filtration $(G^s)_{s \in \R_{\geq -1}}$ can be only be at integers.
\end{theorem}
\begin{proof}
  Omitted. See Serre: Local Fields, chapter 4, section 7.
\end{proof}

\section{Local Class Field Theory}
\subsection{Infinite Galois Theory}
Let $L/K$ be an algebraic extension of fields.
\begin{definition}
  $L/K$ is \emph{separable} if, for every $\alpha \in L$, the minimal polynomial $f_\alpha(x) \in K[x]$ for $\alpha$ is separable. It is \emph{normal} if $f_\alpha(x)$ splits in $L$ for all $\alpha \in K$.

  We then say that $L/K$ is Galois if it is separable and normal. In this case, we write
  \[\Gal(L/K) = \Aut_K(L)\]
\end{definition}
If $L/K$ is finite and Galois, then the Galois correspondence tells us that there is a bijection:
\begin{center}
\begin{tabular}{p{0.4\textwidth}p{0.05\textwidth}p{0.4\textwidth}}
  \raggedleft $\{$subextensions $K \subseteq K'\subseteq L\}$ & $\longleftrightarrow$ & $\{$subgroups of $\Gal(L/K))$\\
  \raggedleft $K'$ & $\longmapsto$ & $\Gal(L/K')$
\end{tabular}
\end{center}
For $L/K$ infinite, we need to introduce a topology. Let $(I \leq)$ be a partially ordered set. We say that $I$ is \emph{directed} if, for all $i, j \in I$, there is some $k \in I$ such that $i \leq k, j\leq k$. For example:
\begin{itemize}
  \item Any total ordered set (e.g. $(\N, \leq)$)/
  \item $(\N_{\geq 1}, |)$ ordered by divisibility.
\end{itemize}
\begin{definition}
  Let $(I, \leq)$ be a directed set and $(G_i)_{i\in I}$ a collection of groups together with transition maps $\varphi_{ij}:G_j \to G_i$ for $i \leq j$ such that $\varphi_{ik} = \varphi_{ij}\circ \varphi_{jk}$ whenever $i \leq j \leq k$, and $\varphi_{ii} = \id$.

  We then say that $((G_i)_{i \in I}, \varphi_{ij})$ is an \emph{inverse system}, and we can define the \emph{inverse limit} of $((G_{i})_{i \in I}, \varphi_{ij})$ as
  \[\lim_{\substack{\leftarrow\\i \in I}} G_i = \{(G_i)_{i \in I} \in \prod_{i\in I}G_i | \varphi_{ij}(g_j) = g_i\}\]
\end{definition}
For $I = (\N, \leq)$, this is just our previous definition. There are projection maps $\psi_j : \lim\limits_{\substack{\leftarrow\\i\in I}} G_i \to G_j$, and this inverse limit satisfies a universal property.

If all the $G_i$ are finite, then we can define the profinite topology on $\lim\limits_{\substack{\leftarrow\\i\in I}} G_i$ as the weakest topology such that the $\psi_j$ are continuous for all $j$.

\begin{proposition}
  Let $L/K$ be Galois. Then
  \begin{enumerate}
    \item The set $I = \{F/K \text{ finite } : F\subseteq L, L/K \text{ Galois}\}$ is a directed set under $\subseteq$.
    \item For $F,F' \in I, F \subseteq F'$, there is a restriction map $\text{res}_{F,F'}:\Gal(F'/K) \to \Gal(F/K)$, and the natural map
    \[\Gal(L/K) \to \lim_{\xleftarrow[F\in I]{}}\Gal(F/K)\]
    is an isomorphism.
  \end{enumerate}
\end{proposition}
\begin{proof}
  Example sheet 4.
\end{proof}
We say that $\Gal(L/K)$ packages all the information of $\Gal(F/K)$ for all finite Galois subextensions.

For example, if $K = \F_q, L = \bar{\F}_q$, then we have a bijection between the finite Galois extensions of $\F_q$ and $\N_{\geq 1}$, namely $\F_{q^n} \mapsto n$.

We then have $\F_{q^m} \subseteq \F_{q^n}$ if and only if $m |n$. The restriction map looks something like:
\begin{center}
  \begin{tikzcd}
    \text{Frob}_q \arrow[hook, harpoon]{r}{\text{generates}} \arrow[leftrightarrow, d] & \Gal(\F_{q^n}/\F_q) \arrow[twoheadrightarrow]{r}{\text{res}} \arrow[leftrightarrow]{d}{\cong} & \Gal(\F_{q^m}/\F_q) \arrow[leftrightarrow]{d}{\cong} & \text{Frob}_q \arrow[hook', harpoon', swap]{l}{\text{generates}} \arrow[leftrightarrow, d]\\
    1 \arrow[hook, harpoon]{r}{\text{generates}} & \Z/n\Z \arrow[twoheadrightarrow]{r}{\text{proj}} & \Z/m\Z & 1 \arrow[hook', harpoon', swap]{l}{\text{generates}}
  \end{tikzcd}
\end{center}
So $\Gal(\bar{\F}_q/\F_q) \cong \lim\limits_{\xleftarrow[n \in (N_{\geq 1}, |)]{}} \Z/n\Z \eqqcolon \hat{\Z}$, generated by the Frobenius automorphism.

On example sheet 3, we show that $\hat{\Z} \cong \prod_{p\text{ prime}}\Z_p$.

Now we then have $\Gal(L/K)$ endowed with the profinite topology, and:
\begin{theorem}[Fundamental Theorem of Galois Theory]
  Let $L/K$ be Galois. Then there is a bijection
  \[\{F/K \text{ subextensions of }L/K\} \leftrightarrow \{\text{closed subgroups of }\Gal(L/K)\}\]
  given by $F \mapsto \Gal(L/F), L^H \mapsfrom H$.

  Moreover, $F/K$ is finite if and only if $\Gal(L/F)$ is open, and $F/K$ is Galois if and only if $\Gal(L/F)$ is normal in $\Gal(L/K)$.
\end{theorem}
\begin{proof}
  Omitted.
\end{proof}
\subsection{Weil Group}
Let $K$ be a local field and $L/K$ a separable algebraic extension.
\begin{definition}\hspace*{0cm}
  \begin{enumerate}
    \item $L/K$ is unramified if $F/K$ is unramified for all $F/K$ finite subextensions.
    \item $L/K$ is totally ramified if $F/K$ is totally ramified for all $F/K$ finite subextensions.
  \end{enumerate}
\end{definition}
\begin{proposition}
  Let $L/K$ be unramified. Then $L/K$ is Galois, and
  \[\Gal(L/K) \cong \Gal(k_L/k)\]
\end{proposition}
\begin{proof}
  Every finite subextension $F/K$ is unramified, hence Galois, and so $L/K$ is normal and separable hence Galois.

  Moreover, there is a commutative diagram
  \begin{center}
    \begin{tikzcd}
      \Gal(L/K) \arrow{r}{\text{res}} \arrow{d}{\cong}& \Gal(k_L/k) \arrow{d}{i}\\
      \lim\limits_{\xleftarrow[\substack{F/K \text{finite}\\ F\subseteq L}]{}}\Gal(F/K) \arrow{r} & \lim\limits_{\xleftarrow[\substack{F/K \text{finite}\\ F\subseteq L}]{}}\Gal(k_F/k)
    \end{tikzcd}
  \end{center}
  Now $\lim\limits_{\xleftarrow[\substack{F/K \text{finite}\\ F\subseteq L}]{}}\Gal(k_F/k) \cong \lim\limits_{\xleftarrow[\substack{L/k \text{finite}\\ L\subseteq k_L}]{}}\Gal(L/k) \cong \Gal(k_L/k)$, where first isomorphism comes from \textbf{14.4} and the second by \textbf{18.4}. Hence $i$ is an isomorphism.
\end{proof}
On example sheet 3, we will show $L_1/K, L_2/K$ finite unramified implies that $L_1L_2/K$ unramified.

Thus, for any $L/K$, there is a maximal unramified subextension $K_0/K$. There is a surjection
\[\text{res}:\Gal(L/K) \surjection \Gal(K_0/K) \cong \Gal(k_l/k)\]
and we write $I_{L/K}$ for the kernel of $\text{res}$, and call the \emph{inertia subgroup}.

Finally, we let $\Frob_{k_L/k} \in \Gal(k_L/k)$ be the Frobenius map $x \mapsto x^{|k|}$, and we let $\angle{\Frob_{k_L/k}}$ be the subgroup generated by $\Frob_{k_L/k}$.
\begin{definition}
  Let $L/K$ be Galois. Then the \emph{Weil group} $W(L/K)$ is the subgroup of $\Gal(L/K)$ which maps to $\angle{\Frob_{k_L/k}} \subseteq \Gal(k_L/k)$, i.e. $\text{res}^{-1}(\angle{\Frob_{k_L/k}})$.
\end{definition}
Note that if $k_L/k$ is finite, then $W(L/K) = \Gal(L/K)$. There is a commutative diagram:
\begin{center}
  \begin{tikzcd}
    0 \arrow{r} & I_{L/K} \arrow[leftrightarrow]{d} \arrow{r} & W(L/K) \arrow[hook]{d} \arrow{r} & \angle{\Frob_{k_L/k}} \arrow[hook]{d} \arrow{r} & 0 \\
    0 \arrow{r} & I_{L/K} \arrow{r} & \Gal(L/K) \arrow{r} & \Gal(k_L/K) \arrow{r} & 0
   \end{tikzcd}
\end{center}
with exact rows.

We endow $W(L/K)$ with the weakest topology such that $I_{L/K}$ is an open subgroup of $W(L/K)$ equipped with its subspace $I_{L/K}\subseteq \Gal(L/K)$.

\textsc{Warning:} If $k_L/k$ is infinite, this is not the subspace topology on $W(L/K)\subseteq \Gal(L/K)$.

\begin{proposition}
  If $L/K$ is a Galois extension of local fields, then:
  \begin{enumerate}
    \item $W(L/K)$ is dense in $\Gal(L/K)$.
    \item If $F/K$ is a finite subextension of $L/K$, then $W(L/F) = W(L/K)\cap \Gal(L/F)$.
    \item If $F/K$ is a finite Galois subextension, then
    \[\frac{W(L/K)}{W(L/F)} \cong \Gal(F/K)\]
  \end{enumerate}
\end{proposition}
\begin{proof}\hspace*{0cm}
  \begin{enumerate}
    \item $W(L/K)$ is dense in $\Gal(L/K)$ if and only if, for all finite Galois subextensions $F/K$, $W(L/K)$ intersects every coset of $\Gal(L/F)$, which occurs if and only if $W(L/K)$ surjects onto $\Gal(F/K)$.

    But note we have a diagram
    \begin{center}
      \begin{tikzcd}
        0 \arrow{r} & I_{L/K} \arrow{d}{a} \arrow{r} & W(L/K) \arrow{d}{b} \arrow{r} & \angle{\Frob_{k_L/k}} \arrow{d}{c} \arrow{r} & 0 \\
        0 \arrow{r} & I_{F/K} \arrow{r} & \Gal(F/K) \arrow{r} & \Gal(k_F/K) \arrow{r} & 0
      \end{tikzcd}
    \end{center}
    Example sheet 4 tells us that $a$ is then surjective.

    Since $\Gal(k_F/k)$ is generated by $\Frob_{k_F/k}$, $c$ is surjective, and then a diagram chase gives $b$ is surjective.

    \item $F/K$ is finite. There is a commutative diagram
    \begin{center}
      \begin{tikzcd}
        \Gal(L/K) \arrow[two heads]{r} & \Gal(k_L/K) & \angle{\Frob_{k_L/k}} \arrow[hook']{l}\\
        \Gal(L/F) \arrow[hook]{u} \arrow[two heads]{r} & \Gal(k_L/k_F) \arrow[hook]{u} & \angle{\Frob_{k_L/k_F}} \arrow[hook']{l} \arrow[hook]{u}
      \end{tikzcd}
    \end{center}
    Hence for $\sigma \in \Gal(L/F)$, $\sigma \in W(L/F) \iff \sigma|_{k_L} \in \angle{\Frob_{k_L/k_F}} \iff \sigma|_{k_L} \in \angle{\Frob_{k_L/k}} \iff \sigma \in W(L/K)$.

    \item $\frac{W(L/K)}{W(L/F)} = \frac{W(L/K)}{W(L/K)\cap \Gal(L/F)} \cong \frac{W(L/K)\Gal(L/F)}{\Gal(L/F)} \cong \frac{\Gal(L/K)}{\Gal(L/F)} \cong \Gal(F/K)$.
  \end{enumerate}
\end{proof}
\section{Local Class Field Theory}
Let $K$ be a non-archimedean local field.
\begin{definition}
  We say $L/K$ is \emph{abelian} if it is Galois and $\Gal(L/K)$ is an abelian group.
\end{definition}
If $L_1/K, L_2/K$ are abelian then it is a fact that
\begin{enumerate}
  \item $L_1L_2/K$ is abelian
  \item If $L_1 \cap L_2 = K$, then there is a canonical isomorphism $\Gal(L_1L_2/K) \to \Gal(L_1/K)\times\Gal(L_2/K)$.
\end{enumerate}
We also have as a fact that there is a maximal abelian extension of $K$, which we denote as $K^{ab}$.

For example, let $K^{ur}$ denote the maximal unramified extension of $K$ inside $K^{sep}$. Then:
\[K^{ur} = \bigcup_{m=1}^\infty K(\zeta_{q^m-1})\]
where $|k| = q, k_{K^{ur}} \cong \bar{\F}_q$.

Then $\Gal(K^{ur}/K) \cong \Gal(\bar{\F}_q/\F_q) \cong \hat\Z$.

So $K^{ur}$ is abelian, and hence contained in $K^{ab}$. Then we have an exact sequence:
\[0 \to I_{K^{ab}/K} \to W(K^{ab}/K) \to \Z \to 0\]
For $L/K$ unramified, let $\Frob_{L/K} \in \Gal(L/K)$ correspond to the Frobenius automorphism on $k_L/k$ (as $\Gal(L/K) \cong \Gal(k_L/k)$).
\begin{theorem}\hspace*{0cm}
  \begin{enumerate}
    \item (Local Artin Reciprocity). There exists a unique topological isomorphism (i.e. an isomorphism of groups and a homeomorphism of topological spaces):
    \[\Art_K : K^\times \to W(K^{ab}/K)\]
    satisfying the properties:
    \begin{enumerate}
      \item $\Art_K(\pi)|_{K^{ur}} = \Frob_{K^{ur}/K}$ for any uniformiser $\pi \in K$.
      \item For each finite subextension $L/K$ in $K^{ab}/K$
      \[\Art_K(N_{L/K}(L^\times))|_L = \{1\}\]
    \end{enumerate}
    $\Art_K$ is called the Artin Reciprocity map.

    \item Let $L/K$ be finite abelian. Then $\Art_K$ induces an isomorphism:
    \[\frac{K^\times}{N_{L/K}(L^\times)} \cong \frac{W(K^{ab}/K)}{W(K^{ab}/L)} \cong \Gal(L/K)\]
  \end{enumerate}
\end{theorem}
Remark: $\Frob_{K^{ur}/K}$ lifts $x\mapsto x^q$ in $\Gal(\bar{\F}_q/\F)$. This is called the ``arithmetic Frobenius." It has an inverse, $(\Frob_{K^{ur}/K})^{-1}$, called the ``geometric Frobenius." There is another normalisation of $\Art_K$ with $\Art_K(\pi)|_{K^{ur}} =(\Frob_{K^{ur}/K})^{-1}$.

\subsection{Properties of the Artim map}
\begin{itemize}
  \item (Existence theorem). For $H \subseteq K^\times$ and open finite subgroup, there is a finite abelian extension $L/K$ such that $N_{L/K}(L^\times) = H$. In particular, $\Art_K$ induces an inclusion reversing isomorphism of posets

  \begin{tabular}{p{0.4\textwidth}p{0.05\textwidth}p{0.4\textwidth}}
    \raggedleft $\{\text{Open finite index subgroup of $K^\times$}\}$ & $\longleftrightarrow$ & $\{\text{finite abelian extensions } L/K\}$\\
    \raggedleft $H$ & $\longmapsto$ & $(K^{ab})^{\Art_K(H)}$\\
    \raggedleft $N_{L/K}(L^\times)$ & $\longmapsfrom$ & $L/K$
  \end{tabular}
  \item (Norm functoriality). Let $L/K$ be a finite separable extension. Then there is a commutative diagram
  \begin{center}
    \begin{tikzcd}
      L^\times \arrow{r}{\Art_L} \arrow{d}{N_{L/K}} & W(L^{ab}/L) \arrow{d}{\text{res}} \\
      K^\times \arrow{r}{\Art_K} & W(K^{ab}/K)
    \end{tikzcd}
  \end{center}
  \item (Compatibility with Higher ramification groups).
  \begin{definition}
    Let $L/K$ be Galois. For $s \in \R_{\geq -1}$, we define
    \[G^s(L/K) = \{\sigma \in \Gal(L/K) : \sigma|_{F} \in G^s(F/K) \text{ for all $F/K$ finite Galois subextensions}\}\]
  \end{definition}
  Corollary \textbf{16.7} tells us that $G^s(L/K)$ is well defined.

  Let $s \in \Z_{\geq 0}$. Then:
  \[\Art_K(U_K^{(s)}) = G^s(K^{ab}/K)\]
  Note that $G^s(K^{ab}/K) \subseteq I_{K^{ab}/K} \subseteq W(K^{ab}/K)$ for $s \geq 0$.
\end{itemize}
\subsection{Construction of $\Art_{\Q_p}$}
Recall that $\Q_p^{ur} = \bigcup_{m=1}^\infty \Q_p(\zeta_{p^m - 1}) = \bigcup_{p \nmid m} \Q_p(\zeta_m)$.

We also saw on example sheet 3 that $\Q_p(\zeta_{p^n})/\Q_p$ gives a totally ramified extension of degree $p^{n-1}(p-1)$, with
\[\theta_n : \Gal(\Q_p(\zeta_p)/\Q_p) \cong (\Z/p^n\Z)^\times\]
For $n\geq m\geq 1$, there is a diagram
\begin{center}
  \begin{tikzcd}
    \Gal(\Q_p(\zeta_{p^n})/\Q_p) \arrow{r}\arrow{d}{\theta_n} & \Gal(\Q_p(\zeta_{p^m})/\Q_p)\arrow{d}{\theta_m}\\
    (\Z/p^n\Z)^\times \arrow{r} & (\Z/p^m\Z)^\times
  \end{tikzcd}
\end{center}
Now set $\Q_p(\zeta_{p^\infty})) = \bigcup_{n=1}^\infty \Q_p(\zeta_{p^n})$. Then $\Q_p(\zeta_{p^\infty})/\Q_p$ is Galois, and we have
\[\theta : \Gal(\Q_p(\zeta_{p^\infty})/\Q_p) \to \lim\limits_{\xleftarrow[n\geq 1]{}}(\Z/p^n\Z)^\times \cong \Z_p^\times\]
We have $\Q_p(\zeta_{p^\infty}) \cap \Q_p^{ur} = \Q_p$.

It then follows that there is an isomorphism
\[\Gal(\Q_p(\zeta_{p^\infty})\Q_p^{ur}/\Q_p)\cong \hat{\Z}\times \Z_p^\times\]
\begin{theorem}[Local Kronecker-Weber]
  \[\Q_p^{ab} = \Q_p^{ur}\Q_p(\zeta_{p^\infty})\]
\end{theorem}
\begin{proof}
  Later.
\end{proof}
The Artin map can now be constructed as follows:

We have $\Q_p^\times \cong \Z\times \Z_p^\times; p^nu \mapsto (n, u)$. Then
\[\Art_{\Q_p}(p^nu) = ((\Frob_{\Q_p^{ur}/\Q_p})^n, \theta^{-1}(u))\]

This definition actually involves an arbitrary choice of a totally ramified extension $\Q_p(\zeta_{p^\infty})$, and there is no ``maximal totally ramified extension" of $\Q_p$. For example, see example sheet 3 q6(b). We also make a choice of a uniformizer $p$, which determines the isomorphism
\[\Q_p^\times \cong \Z\times \Z_p^\times\]
These choices are actually related, and in fact they ``cancel out", so that $\Art_{\Q_p}$ is in fact canonical.

\subsection{General Case}
$\Art_{\Q_p}$ was constructed by constructing a totally ramified extension $\Q_p(\zeta_{p^n})$ with
\[\Gal(\Q_p(\zeta_{p^n})/\Q_p) \cong (\Z/p^n\Z)^\times \cong U_{\Q_p}^{(0)}/U_{\Q_p}^{(s)}\]
In general, if $K$ is a local field and $\pi$ a uniformiser of $K$, then we construct for $n\geq 1$ a totally ramified extension $K_{\pi/n}/K$ satisfying the following:
\begin{enumerate}
  \item $K \subseteq \ldots \subseteq K_{\pi, n} \subseteq K_{\pi, n+1} \subseteq \ldots$
  \item For $n\geq m \geq 1$ there is a diagram
  \begin{center}
    \begin{tikzcd}
      \Gal(K_{\pi,n}/K) \arrow[hook, two heads]{d}{\psi_n} \arrow[two heads]{r} & \Gal(K_{\pi,m}/K) \arrow[two heads, hook]{d}{\psi_m} \\
      \O_K^\times/U_K^{(n)} \arrow[two heads]{r}{\text{canon. projn.}} &\O_K^\times/U_K^{(m)}
    \end{tikzcd}
  \end{center}
  \item  Setting $K_{\pi, \infty} \coloneqq \bigcup_{n=1}^\infty K_{\pi, n}$, we have
  \[K^{ab}= K^{ur}K_{\pi, \infty}\]
  Since $\O_K^\times = U_K^{(0)} \cong \lim\limits_{\xleftarrow[n]{}} O_K^\times/U_K^{(n)}$, (2) gives an isomorphism $\psi: \Gal(K_{\pi, \infty}/K) \cong \O_K^\times$. We can define $\Art_K$ by
  \[K^\times \cong \Z \times \O_K^\times \to \Gal(K^{ur}/K)\times \Gal(K_{\pi, \infty}/K)\]
  \[(\pi^n, u) \mapsto ((\Frob_{K^{ur}/K})^n, \psi^{-1}(u))\]
  We have the following picture:
  \begin{center}
    \begin{tikzcd}
      & \Q_p^{(ab)} \arrow[dash]{dl} \arrow[dash]{dr} & & & K^{ab} \arrow[dash]{dl} \arrow[dash]{dr}& \\
      \Q_p^{ur} \arrow[dash, swap]{dr}{\hat{\Z}} & & \Q_p(\zeta_{p^\infty}) \arrow[dash]{dl}{\Z_p^\times} & K^{ur} \arrow[dash, swap]{dr}{\hat\Z} & & K_{\pi, \infty}\arrow[dash]{dl}{\O_K^\times}\\
      & \Q_p & & & K &
    \end{tikzcd}
  \end{center}
  The goal is then to construct these extensions $K_{\pi, n}$.
\end{enumerate}
\end{document}
